const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/loadingspinner-DNzNT9Ti.js","assets/vendor_react-DXiryTHP.js","assets/vendor-D07iqKQo.js","assets/conceptcard-CDDsxe1s.js","assets/practiceexercises-LXlW4Hw3.js","assets/fittoavatar-BE-ozDqT.js","assets/iconmap-iBemgT8I.js","assets/quiz-DnL6uxM-.js","assets/videosimulationplayer-iOOravJX.js","assets/confetti-UC9rHA8w.js"])))=>i.map(i=>d[i]);
import{r as u,j as e,R as ae,F as qe,a as te,b as Ge,c as De,d as Yt,e as Me,f as Fe,g as Ye,h as Bt,i as Be,k as zt,l as Lt,m as Ut,n as Jt,o as ze,p as _t,q as Le,s as Qt,t as Ue,u as Vt,v as Wt,w as Kt,x as Ht,y as Xt,z as Zt,A as Je,B as es,C as _e,D as ts,E as ss,G as ns,H as as,I as rs}from"./vendor_react-DXiryTHP.js";import{G as os,T as s}from"./vendor-D07iqKQo.js";import{V as is}from"./videosimulationplayer-iOOravJX.js";const ls="AlfanumrikDB",cs=1;let se;const ds=["users","modules","reports","progress","questions","performance","diagrams","feedback","cache","videos","conceptMaps"],Y=()=>new Promise((t,a)=>{if(se)return t(se);const n=indexedDB.open(ls,cs);n.onerror=()=>{console.error("IndexedDB error:",n.error),a("Error opening IndexedDB.")},n.onsuccess=()=>{se=n.result,t(se)},n.onupgradeneeded=r=>{const o=r.target.result;ds.forEach(l=>{if(!o.objectStoreNames.contains(l))switch(l){case"users":o.createObjectStore("users",{keyPath:"id"}).createIndex("email","email",{unique:!0});break;case"questions":o.createObjectStore("questions",{keyPath:"id"}).createIndex("studentId","studentId",{unique:!1});break;case"performance":o.createObjectStore("performance",{autoIncrement:!0}).createIndex("studentId","studentId",{unique:!1});break;case"feedback":o.createObjectStore("feedback",{keyPath:"id"});break;default:o.createObjectStore(l);break}})}}),B=t=>new Promise((a,n)=>{t.onsuccess=()=>a(t.result),t.onerror=()=>n(t.error)}),C=async(t,a)=>{const o=(await Y()).transaction(t,"readonly").objectStore(t);return await B(o.get(a))??null},E=async(t,a,n)=>{const l=(await Y()).transaction(t,"readwrite").objectStore(t);await B(l.put(n,a))},re=async(t,a)=>{const o=(await Y()).transaction(t,"readwrite").objectStore(t);await B(o.add(a))},Xe=async(t,a)=>{const o=(await Y()).transaction(t,"readonly").objectStore(t);return(await B(o.getAll())).filter(a)},ps=async(t,a,n)=>{const l=(await Y()).transaction(t,"readwrite").objectStore(t);await B(l.put(n))},mn=async t=>{const o=(await Y()).transaction("users","readonly").objectStore("users").index("email");return await B(o.get(t.toLowerCase()))??null},hn=async t=>C("users",t),gn=async t=>{await re("users",t)},ne={},fe={},Ze=u.createContext(void 0),yn=({children:t})=>{const[a,n]=u.useState(()=>localStorage.getItem("alfanumrik-language")||"en"),[r,o]=u.useState(!1);u.useEffect(()=>{(async()=>{try{const[h,y,k]=await Promise.all([fetch("./translations/en.json").then(x=>x.json()),fetch("./translations/hi.json").then(x=>x.json()),fetch("./translations/curriculum_hi.json").then(x=>x.json())]);ne.en=h,ne.hi=y,fe.hi=k,fe.en={},o(!0)}catch(h){console.error("Failed to load translation files",h)}})()},[]),u.useEffect(()=>{localStorage.setItem("alfanumrik-language",a),document.documentElement.lang=a},[a]);const l=i=>{n(i)},g=(i,h)=>{var k,x;if(!r)return i;let y=((k=ne[a])==null?void 0:k[i])||((x=ne.en)==null?void 0:x[i])||i;return h&&Object.keys(h).forEach(j=>{y=y.replace(`{{${j}}}`,String(h[j]))}),y},p=i=>{var h;return r&&((h=fe[a])==null?void 0:h[i])||i};return e.jsx(Ze.Provider,{value:{language:a,setLanguage:l,t:g,tCurriculum:p},children:r?t:null})},O=()=>{const t=u.useContext(Ze);if(!t)throw new Error("useLanguage must be used within a LanguageProvider");return t},us=async(t,a)=>{const n=`${t}-${a}`;return C("modules",n)},et=async(t,a,n)=>{const r=`${t}-${n}`;await E("modules",r,a)},fn=async(t,a,n)=>{const r=`report-${a}-${t}-${n}`;return C("reports",r)},xn=async(t,a,n,r)=>{const o=`report-${a}-${t}-${r}`;await E("reports",o,n)},bn=async t=>await Xe("performance",a=>a.studentId===t),ms=()=>new Date().toISOString().split("T")[0],be=()=>{const t=new Date;return t.setDate(t.getDate()-1),t.toISOString().split("T")[0]},wn=async t=>{const a=`streak-${t}`,n=await C("cache",a);return n&&n.lastDate<be()?{count:0,lastDate:n.lastDate}:n},vn=async(t,a)=>{const n=`streak-${t}`,r=ms(),o=await C("cache",n);!o||o.lastDate<be()?await E("cache",n,{count:1,lastDate:r}):o.lastDate===be()&&await E("cache",n,{count:o.count+1,lastDate:r});const l={...a,studentId:t};await re("performance",l)},hs=async(t,a)=>{const n=`${t}-${a}`;return C("progress",n)},Qe=async(t,a,n)=>{const r=`${t}-${n}`;await E("progress",r,a)},Sn=async(t,a)=>await Xe("questions",n=>n.studentId===t),Tn=async(t,a)=>{await re("questions",t)},kn=async(t,a)=>{await ps("questions",t.id,t)},Nn=async t=>C("diagrams",t),An=async(t,a)=>{await E("diagrams",t,a)},Rn=async t=>C("videos",t),jn=async(t,a)=>{await E("videos",t,a)},gs=async t=>C("conceptMaps",t),ys=async(t,a)=>{await E("conceptMaps",t,a)},Cn=async t=>{await re("feedback",t)},In=async t=>{const a=`wellbeing-assigned-${t}`;return await C("cache",a)===!0},En=async(t,a)=>{const n=`wellbeing-assigned-${t}`;await E("cache",n,a)},fs="modulepreload",xs=function(t){return"/AlphaNumrik/"+t},Ve={},oe=function(a,n,r){let o=Promise.resolve();if(n&&n.length>0){let g=function(h){return Promise.all(h.map(y=>Promise.resolve(y).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),i=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));o=g(n.map(h=>{if(h=xs(h),h in Ve)return;Ve[h]=!0;const y=h.endsWith(".css"),k=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${k}`))return;const x=document.createElement("link");if(x.rel=y?"stylesheet":fs,y||(x.as="script"),x.crossOrigin="",x.href=h,i&&x.setAttribute("nonce",i),document.head.appendChild(x),y)return new Promise((j,G)=>{x.addEventListener("load",j),x.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return o.then(g=>{for(const p of g||[])p.status==="rejected"&&l(p.reason);return a().catch(l)})},T=new os({apiKey:"AIzaSyDezSOh-MZmUSBwYcfWu50Tc0aEuwNxD_o"}),bs={chapterTitle:"The Great Transformation: Navigating Your Journey from Teen to Adult",introduction:`Hey there! Ever feel like you're on a roller coaster you didn't even buy a ticket for? One minute, you're a kid, and the next, your body and mind are doing all sorts of new, confusing things. Welcome to the **great transformation**, a journey every single one of us goes through. It's a time of immense change, not just physically, but emotionally and mentally too.

This phase, starting around Grade 7, is when you begin to shed your childhood skin and step into a new one. It can feel awkward and a little scary, but trust us, you're not alone. The goal of this section is to help you understand what's happening to you, so you can embrace these changes, stay focused on your dreams, and emerge stronger and more confident.`,learningObjectives:["Understand the key physical, emotional, and mental changes during adolescence.","Recognize that common struggles like distraction and mood swings are normal during this phase.","Identify healthy coping mechanisms and strategies for managing stress and emotions.","Develop a positive mindset towards personal growth and identity formation."],keyConcepts:[{conceptTitle:"The Science Behind the Changes",explanation:`So, what's really going on? Your brain is undergoing a massive rewiring. The part of your brain responsible for **emotions and risk-taking** (the limbic system) is developing faster than the part that handles **reasoning and decision-making** (the prefrontal cortex).

This developmental mismatch is why you might feel more intense emotions, and why sometimes, a small thing can feel like a huge deal. At the same time, your body is buzzing with hormones that are causing you to grow, change, and develop physically. Understanding this science can help you be a little kinder to yourself when you feel overwhelmed.`,realWorldExample:"Think about why a sad song might suddenly make you feel extremely emotional, or why you might feel a sudden urge to do something risky with friends. It's often your developing emotional brain taking the lead before your reasoning brain has a chance to catch up.",diagramDescription:"A simple diagram of a brain. One part, labeled 'Emotional Center (Limbic System)', is shown brightly lit and larger, with a label 'Developing Fast!'. Another part, labeled 'Reasoning Center (Prefrontal Cortex)', is shown dimmer and smaller, with a label 'Still Developing'."},{conceptTitle:"Case Study: A Tale of Two Students",explanation:`Let's meet two students, Rohan and Priya, both in Grade 9, facing similar challenges.

**Rohan's Story:** Rohan was a fantastic student, but lately, he's feeling easily distracted. He's more interested in spending time with his friends, and feels a lot of pressure to fit in. He finds himself procrastinating, and his grades are starting to slip. He feels guilty but doesn't know how to regain control.

**Priya's Story:** Priya is experiencing mood swings. One minute she's happy and the next she's crying over something small. She feels a huge amount of pressure from her parents to do well in her exams, and is also navigating new friendships and peer groups. She feels exhausted and can't seem to focus on her studies like she used to.

Their feelings are completely normal. These aren't signs of weakness or a lack of focus; they are a direct result of the changes happening inside them. The key is to learn how to **manage these new feelings** and channel that energy in the right direction.`,realWorldExample:"This case study itself is a real-world example. Many students feel exactly like Rohan or Priya when they navigate school pressure, friendships, and internal changes all at once.",diagramDescription:"An illustration showing two students, Rohan and Priya, looking confused. Arrows point from them to icons representing 'procrastination' (a clock), 'peer pressure' (a group of people), 'mood swings' (a happy and a sad mask), and 'exam stress' (a book with a low grade). A separate arrow points towards a toolkit icon, representing the solution."},{conceptTitle:"Your Toolkit for Success",explanation:`So, how do you navigate this? Here are four powerful tools you can use:

1.  **Talk it Out:** Find a trusted adult—a parent, a teacher, a counselor—and talk to them. You'd be surprised how much better you'll feel just by sharing your thoughts.

2.  **Stay Active:** Physical activity is a powerful tool to manage stress and anxiety. Whether it's playing a sport, dancing, or even just going for a walk, it helps clear your mind and boosts your mood.

3.  **Find Your Anchor:** This is a time of exploration, but it helps to have things that ground you. This could be a hobby you love, a goal you're passionate about, or simply your personal values. When you feel overwhelmed, connect with your anchor. Take a deep breath and remind yourself of what's truly important to you.

4.  **Embrace Your Identity:** This journey is about discovering who you are. Embrace your unique interests, strengths, and even your weaknesses. Your value isn't defined by what others think of you.`,realWorldExample:"For example, dedicating time to a hobby like music or art ('Find Your Anchor') can be a great way to express yourself and de-stress. Or, talking to a school counselor ('Talk it Out') can give you strategies to manage the pressures you're feeling.",diagramDescription:"A visual toolkit with four icons inside: one for talking (two speech bubbles), one for physical activity (a person running), one for an anchor (a literal anchor), and one for identity (a simple mirror)."}],summary:"This transformational journey is one of the most exciting and significant parts of your life. By understanding what's happening and using the right tools, you can not only survive it but truly thrive. Remember, every challenge you overcome now will prepare you for the even bigger goals you'll achieve in the future."},ws={chapterTitle:"महान परिवर्तन: किशोर से वयस्क तक की आपकी यात्रा",introduction:`नमस्ते! क्या आपको कभी ऐसा महसूस होता है कि आप एक ऐसी रोलर कोस्टर पर हैं जिसका टिकट भी आपने नहीं खरीदा? एक पल आप बच्चे होते हैं, और अगले ही पल, आपका शरीर और दिमाग हर तरह की नई, भ्रमित करने वाली चीजें करने लगते हैं। **महान परिवर्तन** में आपका स्वागत है, एक ऐसी यात्रा जिससे हम में से हर एक गुजरता है। यह न केवल शारीरिक रूप से, बल्कि भावनात्मक और मानसिक रूप से भी भारी बदलाव का समय है।

यह चरण, जो लगभग कक्षा 7 से शुरू होता है, वह समय है जब आप अपनी बचपन की त्वचा को उतारना शुरू करते हैं और एक नई त्वचा में कदम रखते हैं। यह अजीब और थोड़ा डरावना महसूस हो सकता है, लेकिन हम पर विश्वास करें, आप अकेले नहीं हैं। इस खंड का लक्ष्य आपको यह समझने में मदद करना है कि आपके साथ क्या हो रहा है, ताकि आप इन परिवर्तनों को अपना सकें, अपने सपनों पर ध्यान केंद्रित रख सकें, और मजबूत और अधिक आत्मविश्वासी बनकर उभर सकें।`,learningObjectives:["किशोरावस्था के दौरान होने वाले प्रमुख शारीरिक, भावनात्मक और मानसिक परिवर्तनों को समझना।","यह पहचानना कि ध्यान भटकना और मिजाज में बदलाव जैसी आम मुश्किलें इस चरण में सामान्य हैं।","तनाव और भावनाओं के प्रबंधन के लिए स्वस्थ मुकाबला तंत्र और रणनीतियों की पहचान करना।","व्यक्तिगत विकास और पहचान निर्माण के प्रति सकारात्मक मानसिकता विकसित करना।"],keyConcepts:[{conceptTitle:"परिवर्तनों के पीछे का विज्ञान",explanation:`तो, वास्तव में क्या हो रहा है? आपके मस्तिष्क में एक बड़ा पुनर्विन्यास हो रहा है। आपके मस्तिष्क का वह हिस्सा जो **भावनाओं और जोखिम लेने** (लिम्बिक सिस्टम) के लिए जिम्मेदार है, वह उस हिस्से की तुलना में तेजी से विकसित हो रहा है जो **तर्क और निर्णय लेने** (प्रीफ्रंटल कॉर्टेक्स) का काम करता है।

यह विकासात्मक असंतुलन ही कारण है कि आप अधिक तीव्र भावनाएं महसूस कर सकते हैं, और क्यों कभी-कभी, एक छोटी सी बात बहुत बड़ी बात महसूस हो सकती है। साथ ही, आपका शरीर भी हार्मोन से गुलजार है जो आपको शारीरिक रूप से बढ़ने, बदलने और विकसित होने का कारण बन रहे हैं। इस विज्ञान को समझने से आपको अभिभूत महसूस होने पर खुद के प्रति थोड़ा दयालु होने में मदद मिल सकती है।`,realWorldExample:"सोचिए कि कोई उदास गीत अचानक आपको बहुत भावुक क्यों कर सकता है, या दोस्तों के साथ कुछ जोखिम भरा करने की अचानक इच्छा क्यों होती है। यह अक्सर आपका विकसित हो रहा भावनात्मक मस्तिष्क होता है जो आपके तर्कसंगत मस्तिष्क को पकड़ने का मौका मिलने से पहले ही नेतृत्व कर लेता है।",diagramDescription:"मस्तिष्क का एक सरल चित्र। एक भाग, जिसे 'भावनात्मक केंद्र (लिम्बिक सिस्टम)' कहा जाता है, को उज्ज्वल रूप से प्रकाशित और बड़ा दिखाया गया है, जिस पर 'तेजी से विकसित हो रहा है!' का लेबल लगा है। दूसरा भाग, जिसे 'तर्क केंद्र (प्रीफ्रंटल कॉर्टेक्स)' कहा जाता है, को धुंधला और छोटा दिखाया गया है, जिस पर 'अभी भी विकसित हो रहा है' का लेबल लगा है।"},{conceptTitle:"केस स्टडी: दो छात्रों की कहानी",explanation:`आइए दो छात्रों, रोहन और प्रिया से मिलते हैं, दोनों कक्षा 9 में हैं, जो समान चुनौतियों का सामना कर रहे हैं।

**रोहन की कहानी:** रोहन एक शानदार छात्र था, लेकिन हाल ही में, वह आसानी से विचलित महसूस कर रहा है। वह अपने दोस्तों के साथ समय बिताने में अधिक रुचि रखता है, और फिट होने के लिए बहुत दबाव महसूस करता है। वह खुद को टालमटोल करते हुए पाता है, और उसके ग्रेड गिरने लगे हैं। वह दोषी महसूस करता है लेकिन यह नहीं जानता कि नियंत्रण कैसे वापस पाया जाए।

**प्रिया की कहानी:** प्रिया के मिजाज में उतार-चढ़ाव हो रहा है। एक पल वह खुश होती है और अगले ही पल वह किसी छोटी सी बात पर रोने लगती है। वह अपनी परीक्षाओं में अच्छा करने के लिए अपने माता-पिता से बहुत अधिक दबाव महसूस करती है, और नई दोस्ती और सहकर्मी समूहों को भी नेविगेट कर रही है। वह थका हुआ महसूस करती है और अपनी पढ़ाई पर पहले की तरह ध्यान केंद्रित नहीं कर पाती है।

उनकी भावनाएं पूरी तरह से सामान्य हैं। ये कमजोरी या ध्यान की कमी के संकेत नहीं हैं; वे उनके अंदर हो रहे परिवर्तनों का प्रत्यक्ष परिणाम हैं। कुंजी यह सीखना है कि **इन नई भावनाओं को कैसे प्रबंधित किया जाए** और उस ऊर्जा को सही दिशा में कैसे लगाया जाए।`,realWorldExample:"यह केस स्टडी अपने आप में एक वास्तविक दुनिया का उदाहरण है। बहुत से छात्र स्कूल के दबाव, दोस्ती और आंतरिक परिवर्तनों को एक साथ नेविगेट करते समय बिल्कुल रोहन या प्रिया जैसा महसूस करते हैं।",diagramDescription:"एक चित्रण जिसमें दो छात्र, रोहन और प्रिया, भ्रमित दिख रहे हैं। तीर उनसे 'टालमटोल' (एक घड़ी), 'सहकर्मी दबाव' (लोगों का एक समूह), 'मिजाज में बदलाव' (एक खुश और एक उदास मुखौटा), और 'परीक्षा तनाव' (कम ग्रेड वाली एक किताब) का प्रतिनिधित्व करने वाले आइकन की ओर इशारा करते हैं। एक अलग तीर समाधान का प्रतिनिधित्व करने वाले एक टूलकिट आइकन की ओर इशारा करता है।"},{conceptTitle:"आपकी सफलता की टूलकिट",explanation:`तो, आप इसे कैसे संभालते हैं? यहाँ चार शक्तिशाली उपकरण दिए गए हैं जिनका आप उपयोग कर सकते हैं:

1.  **बात करें:** किसी विश्वसनीय वयस्क से बात करें—एक माता-पिता, एक शिक्षक, एक परामर्शदाता। आप केवल अपने विचार साझा करके कितना बेहतर महसूस करेंगे, इस पर आपको आश्चर्य होगा।

2.  **सक्रिय रहें:** शारीरिक गतिविधि तनाव और चिंता को प्रबंधित करने का एक शक्तिशाली उपकरण है। चाहे वह कोई खेल खेलना हो, नृत्य करना हो, या सिर्फ टहलने जाना हो, यह आपके दिमाग को साफ करने और आपके मूड को बेहतर बनाने में मदद करता है।

3.  **अपना एंकर खोजें:** यह खोज का समय है, लेकिन ऐसी चीजें रखना मददगार होता है जो आपको स्थिर रखती हैं। यह आपका कोई पसंदीदा शौक हो सकता है, कोई ऐसा लक्ष्य जिसके प्रति आप जुनूनी हों, या बस आपके व्यक्तिगत मूल्य। जब आप अभिभूत महसूस करें, तो अपने एंकर से जुड़ें। एक गहरी सांस लें और खुद को याद दिलाएं कि आपके लिए वास्तव में क्या महत्वपूर्ण है।

4.  **अपनी पहचान को अपनाएं:** यह यात्रा यह खोजने के बारे में है कि आप कौन हैं। अपनी अनूठी रुचियों, शक्तियों और यहां तक कि अपनी कमजोरियों को भी अपनाएं। आपका मूल्य इस बात से परिभाषित नहीं होता है कि दूसरे आपके बारे में क्या सोचते हैं।`,realWorldExample:"उदाहरण के लिए, संगीत या कला जैसे किसी शौक के लिए समय समर्पित करना ('अपना एंकर खोजें') खुद को अभिव्यक्त करने और तनाव दूर करने का एक शानदार तरीका हो सकता है। या, एक स्कूल परामर्शदाता से बात करना ('बात करें') आपको महसूस हो रहे दबावों को प्रबंधित करने के लिए रणनीतियाँ दे सकता है।",diagramDescription:"एक दृश्य टूलकिट जिसके अंदर चार आइकन हैं: बात करने के लिए एक (दो भाषण बुलबुले), शारीरिक गतिविधि के लिए एक (एक दौड़ता हुआ व्यक्ति), एक एंकर के लिए एक (एक शाब्दिक एंकर), और पहचान के लिए एक (एक साधारण दर्पण)।"}],summary:"यह परिवर्तनकारी यात्रा आपके जीवन के सबसे रोमांचक और महत्वपूर्ण हिस्सों में से एक है। क्या हो रहा है, यह समझकर और सही उपकरणों का उपयोग करके, आप न केवल इससे बच सकते हैं, बल्कि वास्तव में फल-फूल सकते हैं। याद रखें, अब आप जिस भी चुनौती को पार करते हैं, वह आपको भविष्य में प्राप्त होने वाले और भी बड़े लक्ष्यों के लिए तैयार करेगी।"},vs={type:s.OBJECT,properties:{conceptTitle:{type:s.STRING},explanation:{type:s.STRING},realWorldExample:{type:s.STRING},diagramDescription:{type:s.STRING}},required:["conceptTitle","explanation","realWorldExample","diagramDescription"]},tt={type:s.OBJECT,properties:{name:{type:s.STRING},proof:{type:s.STRING}},required:["name","proof"]},st={type:s.OBJECT,properties:{formula:{type:s.STRING},derivation:{type:s.STRING}},required:["formula","derivation"]},nt={type:s.OBJECT,properties:{question:{type:s.STRING},solution:{type:s.STRING}},required:["question","solution"]},at={type:s.OBJECT,properties:{name:{type:s.STRING},explanation:{type:s.STRING}},required:["name","explanation"]},rt={type:s.OBJECT,properties:{question:{type:s.STRING},hint:{type:s.STRING}},required:["question","hint"]},ot={type:s.OBJECT,properties:{formula:{type:s.STRING},description:{type:s.STRING}},required:["formula","description"]},it={type:s.OBJECT,properties:{problemType:{type:s.STRING},steps:{type:s.ARRAY,items:{type:s.STRING}}},required:["problemType","steps"]},xe={type:s.OBJECT,properties:{question:{type:s.STRING},solution:{type:s.STRING}},required:["question","solution"]},lt={type:s.OBJECT,properties:{conceptual:{type:s.ARRAY,items:xe},application:{type:s.ARRAY,items:xe},higherOrderThinking:{type:s.ARRAY,items:xe}},required:["conceptual","application","higherOrderThinking"]},ct={type:s.OBJECT,properties:{mistake:{type:s.STRING},correction:{type:s.STRING}},required:["mistake","correction"]},dt={type:s.OBJECT,properties:{title:{type:s.STRING},description:{type:s.STRING},materials:{type:s.ARRAY,items:{type:s.STRING}},steps:{type:s.ARRAY,items:{type:s.STRING}},safetyGuidelines:{type:s.STRING}},required:["title","description","materials","steps","safetyGuidelines"]},pt={type:s.OBJECT,properties:{year:{type:s.STRING},event:{type:s.STRING},significance:{type:s.STRING}},required:["year","event","significance"]},ut={type:s.OBJECT,properties:{name:{type:s.STRING},contribution:{type:s.STRING}},required:["name","contribution"]},mt={type:s.OBJECT,properties:{sourceTitle:{type:s.STRING},snippet:{type:s.STRING},analysis:{type:s.STRING}},required:["sourceTitle","snippet","analysis"]},ht={type:s.OBJECT,properties:{title:{type:s.STRING},background:{type:s.STRING},analysis:{type:s.STRING},conclusion:{type:s.STRING}},required:["title","background","analysis","conclusion"]},gt={type:s.OBJECT,properties:{ruleName:{type:s.STRING},explanation:{type:s.STRING},examples:{type:s.ARRAY,items:{type:s.STRING}}},required:["ruleName","explanation","examples"]},yt={type:s.OBJECT,properties:{deviceName:{type:s.STRING},explanation:{type:s.STRING},example:{type:s.STRING}},required:["deviceName","explanation","example"]},ft={type:s.OBJECT,properties:{term:{type:s.STRING},definition:{type:s.STRING},usageInSentence:{type:s.STRING},etymology:{type:s.STRING,nullable:!0}},required:["term","definition","usageInSentence"]},Ss={type:s.OBJECT,properties:{title:{type:s.STRING},description:{type:s.STRING,description:"Explains what the simulation will show and why it's useful."},videoPrompt:{type:s.STRING,description:"The detailed prompt for the VEO model."}},required:["title","description","videoPrompt"]},Ts={type:s.OBJECT,properties:{chapterTitle:{type:s.STRING},introduction:{type:s.STRING},learningObjectives:{type:s.ARRAY,items:{type:s.STRING}},keyConcepts:{type:s.ARRAY,items:vs},summary:{type:s.STRING},conceptMap:{type:s.STRING,nullable:!0},learningTricksAndMnemonics:{type:s.ARRAY,items:{type:s.STRING},nullable:!0},higherOrderThinkingQuestions:{type:s.ARRAY,items:rt,nullable:!0},competitiveExamMapping:{type:s.STRING,nullable:!0},interactiveVideoSimulation:{...Ss,nullable:!0},prerequisitesCheck:{type:s.ARRAY,items:{type:s.STRING},nullable:!0},selfAssessmentChecklist:{type:s.ARRAY,items:{type:s.STRING},nullable:!0},extensionActivities:{type:s.ARRAY,items:{type:s.STRING},nullable:!0},remedialActivities:{type:s.ARRAY,items:{type:s.STRING},nullable:!0},careerConnections:{type:s.STRING,nullable:!0},technologyIntegration:{type:s.STRING,nullable:!0},keyTheoremsAndProofs:{type:s.ARRAY,items:tt,nullable:!0},formulaDerivations:{type:s.ARRAY,items:st,nullable:!0},formulaSheet:{type:s.ARRAY,items:ot,nullable:!0},problemSolvingTemplates:{type:s.ARRAY,items:it,nullable:!0},categorizedProblems:{...lt,nullable:!0},commonMistakes:{type:s.ARRAY,items:ct,nullable:!0},keyLawsAndPrinciples:{type:s.ARRAY,items:at,nullable:!0},solvedNumericalProblems:{type:s.ARRAY,items:nt,nullable:!0},experiments:{type:s.ARRAY,items:dt,nullable:!0},scientificMethodApplications:{type:s.STRING,nullable:!0},currentDiscoveries:{type:s.STRING,nullable:!0},environmentalAwareness:{type:s.STRING,nullable:!0},interdisciplinaryConnections:{type:s.STRING,nullable:!0},timelineOfEvents:{type:s.ARRAY,items:pt,nullable:!0},keyFigures:{type:s.ARRAY,items:ut,nullable:!0},primarySourceAnalysis:{type:s.ARRAY,items:mt,nullable:!0},inDepthCaseStudies:{type:s.ARRAY,items:ht,nullable:!0},grammarSpotlight:{type:s.ARRAY,items:gt,nullable:!0},literaryDeviceAnalysis:{type:s.ARRAY,items:yt,nullable:!0},vocabularyDeepDive:{type:s.ARRAY,items:ft,nullable:!0}},required:["chapterTitle","introduction","learningObjectives","keyConcepts","summary"]},we={type:s.ARRAY,items:{type:s.OBJECT,properties:{question:{type:s.STRING},options:{type:s.ARRAY,items:{type:s.STRING}},correctAnswer:{type:s.STRING},explanation:{type:s.STRING},conceptTitle:{type:s.STRING}},required:["question","options","correctAnswer","explanation","conceptTitle"]}},ks={type:s.OBJECT,properties:{recommendationText:{type:s.STRING},nextChapterTitle:{type:s.STRING,nullable:!0},action:{type:s.STRING,enum:["REVIEW","CONTINUE","REVISE_PREREQUISITE"]},prerequisiteChapterTitle:{type:s.STRING,nullable:!0}},required:["recommendationText","action"]},Ns={type:s.OBJECT,properties:{modelAnswer:{type:s.STRING,description:"A well-explained, grade-appropriate model answer for the student."},pedagogicalNotes:{type:s.STRING,description:"Private, actionable advice for the teacher on how to explain the concept, including common misconceptions and key points to emphasize in line with CBSE standards."}},required:["modelAnswer","pedagogicalNotes"]},As={type:s.OBJECT,properties:{isRelevant:{type:s.BOOLEAN,description:"A boolean flag indicating if the question is relevant to the academic concept and grade level."},responseText:{type:s.STRING,description:"The answer to the student's question, or a polite redirection if the question is not relevant."}},required:["isRelevant","responseText"]},Rs={type:s.ARRAY,items:{type:s.OBJECT,properties:{question:{type:s.STRING},options:{type:s.ARRAY,items:{type:s.STRING}},correctAnswer:{type:s.STRING},explanation:{type:s.STRING},skill:{type:s.STRING,enum:["Pattern Recognition","Logic Puzzle","Spatial Reasoning","Analogical Reasoning"]}},required:["question","options","correctAnswer","explanation","skill"]}},js={type:s.ARRAY,items:{type:s.OBJECT,properties:{scenario:{type:s.STRING},question:{type:s.STRING},options:{type:s.ARRAY,items:{type:s.STRING}},bestResponse:{type:s.STRING},explanation:{type:s.STRING},skill:{type:s.STRING,enum:["Empathy","Self-awareness","Resilience","Social Skills"]}},required:["scenario","question","options","bestResponse","explanation","skill"]}},Cs={type:s.OBJECT,properties:{type:{type:s.STRING,enum:["ACADEMIC_REVIEW","ACADEMIC_PRACTICE","ACADEMIC_NEW","IQ_EXERCISE","EQ_EXERCISE"]},details:{type:s.OBJECT,properties:{subject:{type:s.STRING,nullable:!0},chapter:{type:s.STRING,nullable:!0},concept:{type:s.STRING,nullable:!0},skill:{type:s.STRING,nullable:!0},reasoning:{type:s.STRING},confidence:{type:s.NUMBER,description:"A confidence score from 0.0 to 1.0 for the recommendation."}},required:["reasoning","confidence"]}},required:["type","details"]},Is={type:s.OBJECT,properties:{chapterTitle:{type:s.STRING},learningObjectives:{type:s.ARRAY,items:{type:s.STRING}}},required:["chapterTitle","learningObjectives"]},Es={type:s.ARRAY,items:Is},Os=async(t,a,n,r,o)=>{if(n==="The Great Transformation: Navigating Your Journey from Teen to Adult")return o==="hi"?ws:bs;const l=`
        **SYSTEM ROLE:**
        You are an expert educational content creator for the Indian K-12 CBSE curriculum. Your goal is to produce the foundational content for a learning module. Your entire response must be in the ${o} language.

        **CONTENT MISSION:**
        Create the core learning module for a ${t} student named ${r} on the chapter "${n}" in ${a}. The tone should be authoritative yet encouraging.

        **QUALITY STANDARDS (MANDATORY):**
        1.  **Pedagogical Excellence & CBSE Alignment:** Align with the latest CBSE syllabus (2024-25) and NCERT textbooks.
        2.  **Accuracy:** All information must be factually correct.
        3.  **Cultural Sensitivity:** Use Indian contexts and examples where appropriate.

        **CONTENT GENERATION GUIDE (Generate ONLY these core sections):**
        -   **chapterTitle**: Must be "${n}".
        -   **introduction**: Start with a hook to grab the student's attention.
        -   **learningObjectives**: List the specific, measurable learning outcomes based on the CBSE syllabus.
        -   **prerequisitesCheck**: A list of concepts the student should know before starting this chapter.
        -   **keyConcepts**: This is the most critical part. For each concept, provide:
            -   \`conceptTitle\`: A clear title.
            -   \`explanation\`: A step-by-step, easy-to-understand breakdown.
            -   \`realWorldExample\`: A relatable application, preferably in an Indian context.
            -   \`diagramDescription\`: A detailed description for a visual aid.
        -   **formulaSheet**: For subjects like Mathematics, Physics, or Chemistry, generate a concise list of all relevant formulas. Each formula should have a brief, clear description. If the chapter has no formulas, this field can be null.
        -   **summary**: A concise summary of the key takeaways.
        -   **conceptMap**: If the chapter involves complex relationships (e.g., flowcharts, cycles), provide a detailed, descriptive prompt for an AI image generator (like Imagen) to create a concept map. For simple chapters, this can be null.
        -   **interactiveVideoSimulation**: For one key concept that is highly visual or hard to explain with text, generate an engaging video simulation section. The \`videoPrompt\` should be a detailed prompt for a model like Google VEO. For other chapters, this can be null.

        **DO NOT GENERATE THE FOLLOWING SECTIONS IN THIS REQUEST:**
        - Do not generate \`categorizedProblems\`, \`experiments\`, \`commonMistakes\`, or any other deep pedagogical sections. These will be generated on-demand later.

        **FINAL INSTRUCTION:**
        Your entire output MUST be a JSON object that strictly follows the 'LearningModule' schema, but only containing the core fields listed above. Ensure all text fields are complete. No markdown, just plain text with newline characters (\\n) for breaks.
    `;try{const p=(await T.models.generateContent({model:"gemini-2.5-flash",contents:l,config:{responseMimeType:"application/json",responseSchema:Ts,temperature:.8}})).text.trim();return JSON.parse(p)}catch(g){throw console.error("Error generating chapter content:",g),new Error("Failed to generate learning content from AI. Please try again.")}},$s={keyTheoremsAndProofs:{type:s.ARRAY,items:tt},formulaDerivations:{type:s.ARRAY,items:st},formulaSheet:{type:s.ARRAY,items:ot},problemSolvingTemplates:{type:s.ARRAY,items:it},categorizedProblems:lt,commonMistakes:{type:s.ARRAY,items:ct},keyLawsAndPrinciples:{type:s.ARRAY,items:at},solvedNumericalProblems:{type:s.ARRAY,items:nt},experiments:{type:s.ARRAY,items:dt},timelineOfEvents:{type:s.ARRAY,items:pt},keyFigures:{type:s.ARRAY,items:ut},primarySourceAnalysis:{type:s.ARRAY,items:mt},inDepthCaseStudies:{type:s.ARRAY,items:ht},grammarSpotlight:{type:s.ARRAY,items:gt},literaryDeviceAnalysis:{type:s.ARRAY,items:yt},vocabularyDeepDive:{type:s.ARRAY,items:ft},higherOrderThinkingQuestions:{type:s.ARRAY,items:rt},learningTricksAndMnemonics:{type:s.ARRAY,items:{type:s.STRING}},scientificMethodApplications:{type:s.STRING},currentDiscoveries:{type:s.STRING},environmentalAwareness:{type:s.STRING},interdisciplinaryConnections:{type:s.STRING},selfAssessmentChecklist:{type:s.ARRAY,items:{type:s.STRING}},extensionActivities:{type:s.ARRAY,items:{type:s.STRING}},remedialActivities:{type:s.ARRAY,items:{type:s.STRING}},careerConnections:{type:s.STRING},technologyIntegration:{type:s.STRING},competitiveExamMapping:{type:s.STRING}},Ps=async(t,a,n,r,o,l)=>{const g=$s[o];if(!g)throw new Error(`No schema defined for section: ${o}`);const p=`
        **SYSTEM ROLE:**
        You are an expert educational content creator for the Indian K-12 CBSE curriculum. Your task is to generate a specific, detailed pedagogical section for an existing learning module. Your entire response must be in the ${r} language.

        **MISSION CONTEXT:**
        -   **Grade:** ${t}
        -   **Subject:** ${a}
        -   **Chapter:** "${n}"
        -   **Chapter Core Content:** ${l}

        **TASK:**
        Generate the content ONLY for the section named "${o}". Your output must be comprehensive, pedagogically sound, and aligned with the latest CBSE standards (2024-25).

        **SPECIAL INSTRUCTIONS for 'categorizedProblems':**
        If you are generating the "categorizedProblems" section, you MUST adhere to the following grade-specific guidelines for question generation:
        -   **Grades 11-12:** Generate at least 40 practice questions. The questions must be meticulously designed based on the last 10 years of CBSE exam patterns, including MCQs, Short Answer (SA-I, SA-II), Long Answer (LA), Case-Based, and Assertion-Reasoning questions.
        -   **Grades 9-10:** Generate at least 35 practice questions. The questions must be designed based on the last 10 years of CBSE exam patterns, including MCQs, VSA, SA, LA, and Case-Based questions.
        -   **Grades 6-8:** Generate a solid bank of at least 25 practice questions based on middle school examination patterns, including MCQs, VSA, and SA questions.
        -   **Below Grade 6:** Generate a set of 15 practice questions focused on reinforcing core concepts.
        
        For all other sections, provide rich, detailed, and accurate content appropriate for the grade level.

        **FINAL INSTRUCTION:**
        Your entire output MUST be a JSON object containing a single key: "${o}". The value of this key must strictly follow the provided schema for that section. Do not include any other keys or markdown.
    `;try{const h=(await T.models.generateContent({model:"gemini-2.5-flash",contents:p,config:{responseMimeType:"application/json",responseSchema:{type:s.OBJECT,properties:{[o]:g},required:[o]},temperature:.8}})).text.trim();return JSON.parse(h)}catch(i){throw console.error(`Error generating section content for "${o}":`,i),new Error(`Failed to generate the "${o}" section from AI. Please try again.`)}},qs=async(t,a,n=5)=>{const r=t.map(l=>l.conceptTitle),o=`
        Based on the following key concepts, create a ${n}-question multiple-choice quiz. The questions
        should test conceptual understanding and application of knowledge. The entire response, including all
        questions, options, answers, explanations, and concept titles, must be in the ${a} language.

        For each question:
        1.  Provide a clear question.
        2.  Provide four distinct options, with one being the correct answer.
        3.  Indicate the correct answer.
        4.  Provide a brief explanation for why the correct answer is right.
        5.  **Crucially, you must associate each question with one of the provided concept titles.** Use the 'conceptTitle' field for this.

        Key Concepts:
        ---
        ${t.map(l=>`Title: ${l.conceptTitle}
Explanation: ${l.explanation}`).join(`

`)}
        ---

        Valid Concept Titles for the 'conceptTitle' field: ${r.join(", ")}
    `;try{const g=(await T.models.generateContent({model:"gemini-2.5-flash",contents:o,config:{responseMimeType:"application/json",responseSchema:we,temperature:.8}})).text.trim();return JSON.parse(g)}catch(l){throw console.error("Error generating quiz:",l),new Error("Failed to generate quiz from AI. Please try again.")}},On=async(t,a,n)=>{const r=`
        Generate 3 multiple-choice questions for a ${a} student to practice and drill the specific concept of "${t.conceptTitle}".
        The entire response, including all questions, options, answers, explanations, and concept titles, must be in the ${n} language.

        The questions should be focused on reinforcing the core skill of the concept, not on broad, complex problem-solving. They should be direct and clear.
        For example, if the concept is 'Simple Addition', questions should be direct calculations like '5 + 7 = ?'.
        If the concept is 'Identifying Nouns', questions should be like 'Which word in the following sentence is a noun?'.

        For each question:
        1. Provide a clear question.
        2. Provide four distinct options, with one being the correct answer.
        3. Indicate the correct answer.
        4. Provide a brief explanation for the answer.
        5. **Crucially, for the 'conceptTitle' field, you must use the exact title provided: "${t.conceptTitle}"**.

        Concept Details for context:
        Explanation: ${t.explanation}
        Real-World Example: ${t.realWorldExample}
    `;try{const l=(await T.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:we,temperature:.7}})).text.trim();return JSON.parse(l)}catch(o){throw console.error("Error generating practice exercises:",o),new Error("Failed to generate practice exercises from AI. Please try again.")}},$n=async(t,a,n)=>{const r=`
        Create a 5-question diagnostic multiple-choice quiz for a ${t} student in the subject of ${a}.
        The entire response, including all questions, options, answers, and explanations, must be in the ${n} language.

        The goal is to assess their foundational knowledge and identify their current skill level.
        The quiz should include:
        - 1-2 questions covering prerequisite concepts from the previous grade.
        - 2-3 questions on core, fundamental topics for the current ${t} syllabus.
        - 1 question that is slightly more challenging to gauge advanced understanding.

        For each question, provide a clear question, four distinct options, the correct answer, a brief explanation,
        and for the 'conceptTitle' field, use a generic title like 'Foundational Knowledge' or the specific topic being tested.
    `;try{const l=(await T.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:we,temperature:.8}})).text.trim();return JSON.parse(l)}catch(o){throw console.error("Error generating diagnostic test:",o),new Error("Failed to generate diagnostic test from AI.")}},Gs=t=>new Promise(a=>setTimeout(a,t)),Pn=async(t,a)=>{let n="friendly, simple, engaging cartoonish style.";const r=a.toLowerCase();["computer science","robotics","ai and machine learning"].some(p=>r.includes(p))?n="clean, modern, digital illustration style with simple icons, abstract shapes, or flowcharts. Futuristic but easy to understand.":["science","physics","chemistry","biology","evs"].some(p=>r.includes(p))?n='clean, "science textbook" illustration style with clear outlines and vibrant colors. For biological diagrams, parts must be distinct and simple. For chemical diagrams, molecules and bonds must be clear.':r.includes("mathematics")?n="precise geometric shapes, clean lines, and clearly marked angles or points. Modern math textbook style.":["history","social studies","geography","political science","economics"].some(p=>r.includes(p))&&(n="simple infographic, a stylized map, or a timeline with friendly icons.");const o=`Generate a minimalist, 2D educational diagram for a K-12 student. The diagram should illustrate: "${t}".
**Positive Requirements:**
-   **Text-free:** Absolutely no words, letters, or numbers.
-   **Clarity:** Clean lines, simple shapes, and a plain white background.
-   **Style:** ${n}.
-   **Conceptually Accurate:** The visual representation must be correct and easy to understand.
**Negative Requirements (AVOID):**
-   Overly complex scenes or backgrounds.
-   3D rendering, shadows, or photorealism.
-   Text labels or annotations.
-   Confusing or abstract metaphors.`,l=3;let g=null;for(let p=0;p<l;p++)try{const i=await T.models.generateImages({model:"imagen-4.0-generate-001",prompt:o,config:{numberOfImages:1,outputMimeType:"image/png",aspectRatio:"16:9"}});if(i.generatedImages&&i.generatedImages.length>0)return`data:image/png;base64,${i.generatedImages[0].image.imageBytes}`;throw new Error("No image was generated by the AI.")}catch(i){g=i;const h=(i.message||"").toLowerCase();if(h.includes("quota"))throw console.error("Gemini API daily quota exceeded for image generation."),new Error("QUOTA_EXCEEDED");if((h.includes("rate limit")||i.status==="RESOURCE_EXHAUSTED")&&p<l-1){const y=Math.pow(2,p)*1e3+Math.random()*1e3;console.warn(`Rate limit hit. Retrying in ${Math.round(y/1e3)}s...`),await Gs(y);continue}break}throw console.error("Error generating diagram after multiple retries:",g),new Error("Failed to generate diagram from AI after multiple attempts.")},Ds=async t=>{const a=`Create a visually appealing, K-12 friendly infographic-style concept map based on this description: "${t}". The map should be clean, with clear labels and connecting lines, on a plain white background. It should look like a modern educational illustration. Do not include any text that is not part of the described labels.`;try{const n=await T.models.generateImages({model:"imagen-4.0-generate-001",prompt:a,config:{numberOfImages:1,outputMimeType:"image/png",aspectRatio:"16:9"}});if(n.generatedImages&&n.generatedImages.length>0)return`data:image/png;base64,${n.generatedImages[0].image.imageBytes}`;throw new Error("No concept map image was generated by the AI.")}catch(n){throw console.error("Error generating concept map image:",n),new Error("Failed to generate concept map image from AI.")}},qn=async t=>{var a,n,r,o;try{let l=await T.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{numberOfVideos:1}});for(;!l.done;)await new Promise(h=>setTimeout(h,1e4)),l=await T.operations.getVideosOperation({operation:l});const g=(o=(r=(n=(a=l.response)==null?void 0:a.generatedVideos)==null?void 0:n[0])==null?void 0:r.video)==null?void 0:o.uri;if(!g)throw new Error("Video generation completed, but no download link was provided.");const p=await fetch(`${g}&key=AIzaSyDezSOh-MZmUSBwYcfWu50Tc0aEuwNxD_o`);if(!p.ok)throw new Error(`Failed to download video: ${p.statusText}`);return await p.blob()}catch(l){throw console.error("Error generating video:",l),new Error("Failed to generate video from AI. Please try again.")}},Ms=async(t,a,n,r,o,l,g)=>{const p=Math.round(r/o*100),i=l.map(x=>x.title).join('", "'),h=l.findIndex(x=>x.title===n),y=h!==-1&&h<l.length-1?l[h+1]:null,k=`
        Act as an expert, encouraging learning coach for a ${t} student studying ${a}.
        The student has just completed a quiz on the chapter "${n}" and scored ${r} out of ${o} (${p}%).
        The available chapters in this subject are: ["${i}"].
        The entire response must be in the ${g} language.

        Based on this performance, provide a personalized recommendation for their next step. Your response must be in a specific JSON format.
        
        1.  **If the score is below 60% (${p}%):**
            - The student is struggling. Your tone should be very encouraging and normalize the struggle.
            - **Analysis:** Analyze the chapter title "${n}". Does it sound like an advanced topic that might depend on earlier concepts? For example, "Polynomials" depends on "Real Numbers". "Trigonometry" depends on "Triangles". "Calculus" depends on "Functions".
            - **If it seems to have a prerequisite:**
                - **action**: "REVISE_PREREQUISITE"
                - **prerequisiteChapterTitle**: Identify the most likely prerequisite chapter from the available chapter list. For example, if the current chapter is "Polynomials", you should identify "Real Numbers".
                - **recommendationText**: Explain that this topic builds on earlier ideas and suggest they strengthen their foundation by reviewing the prerequisite chapter you identified.
            - **If it seems foundational or you can't determine a prerequisite:**
                - **action**: "REVIEW"
                - **recommendationText**: Explain that it's perfectly normal and suggest they review the key concepts of the current chapter ("${n}") to build a stronger foundation.
                - **prerequisiteChapterTitle**: null
        
        2.  **If the score is between 60% and 85% (inclusive of ${p}%):**
            - The student has a decent grasp. Congratulate them on their effort.
            - **action**: "CONTINUE"
            - **recommendationText**: Suggest they have a good understanding and are ready for the next challenge. Mention the next chapter by name.
            - **nextChapterTitle**: "${y?y.title:null}"
            - **prerequisiteChapterTitle**: null

        3.  **If the score is above 85% (${p}%):**
            - The student has mastered the material. Be very positive and praise their excellent work.
            - **action**: "CONTINUE"
            - **recommendationText**: Tell them they did an amazing job and are clearly ready to move on. Name the next chapter.
            - **nextChapterTitle**: "${y?y.title:null}"
            - **prerequisiteChapterTitle**: null
        
        If there is no next chapter available, set nextChapterTitle to null and adjust the text to say they've completed the subject.
    `;try{const j=(await T.models.generateContent({model:"gemini-2.5-flash",contents:k,config:{responseMimeType:"application/json",responseSchema:ks,temperature:.6}})).text.trim();return JSON.parse(j)}catch(x){throw console.error("Error generating recommendation:",x),new Error("Failed to generate recommendation from AI.")}},Gn=async(t,a)=>{const n=`
        Act as an experienced educator and data analyst. Based on the following comprehensive performance data for a student named ${t.name} (${t.grade}), 
        generate a detailed academic performance analysis report. The entire report must be in the ${a} language.

        **VERY IMPORTANT FORMATTING RULES:**
        - Each section heading MUST be enclosed in double asterisks and end with a colon. For example: **Overall Summary:**
        - Under each heading, use bullet points for lists. Each bullet point MUST start with a hyphen (-).

        The report MUST be structured with the following sections:
        1.  **Overall Summary:** A brief, holistic overview of the student's performance.
        2.  **Identified Strengths:** A bulleted list of subjects or chapters where the student has excelled (scores > 85%). Be specific.
        3.  **Areas for Improvement:** A bulleted list of subjects or chapters where the student is struggling (scores < 70%). Frame this constructively.
        4.  **Study Patterns & Trends:** A detailed analysis using bullet points for specific observations. Analyze:
            - Quiz vs. Practice Frequency.
            - Response to Difficulty (e.g., using exercises after a low quiz score).
            - Pacing and Consistency from timestamps.
        5.  **Actionable Recommendations:** A bulleted list of concrete, pedagogical suggestions for the teacher.

        Student Performance Data (includes quizzes and practice exercises):
        ---
        ${JSON.stringify(t.performance,null,2)}
        ---
        
        Keep the tone professional, insightful, and focused on student growth.
    `;try{return(await T.models.generateContent({model:"gemini-2.5-flash",contents:n})).text}catch(r){throw console.error("Error generating teacher report:",r),new Error("Failed to generate teacher report from AI.")}},Dn=async(t,a)=>{const n=`
        Act as a friendly and encouraging school counselor. Based on the following performance data for a student named ${t.name} (${t.grade}), 
        write a progress report for their parents. The entire report must be in the ${a} language.

        **VERY IMPORTANT FORMATTING RULES:**
        - Section headings should be friendly and enclosed in double asterisks, ending with a colon. For example: **Where ${t.name} is Shining:**
        - Use bullet points for lists. Each bullet point MUST start with a hyphen (-).

        The report should be easy to understand, positive, and supportive. Structure it with the following sections:
        1.  **A Quick Note on ${t.name}'s Progress:** A warm opening celebrating their effort.
        2.  **Where ${t.name} is Shining:** A bulleted list of subjects where they are doing well.
        3.  **Opportunities for Growth:** A bulleted list of areas to focus on, framed positively.
        4.  **How ${t.name} is Learning:** Simple, encouraging observations about their study habits in a bulleted list (e.g., consistency, resilience).
        5.  **Tips for Home Support:** A bulleted list of simple, actionable tips for parents.

        Student Performance Data (includes quizzes and practice exercises):
        ---
        ${JSON.stringify(t.performance,null,2)}
        ---
        
        The tone should be empathetic and collaborative, making parents feel like partners in their child's education.
    `;try{return(await T.models.generateContent({model:"gemini-2.5-flash",contents:n})).text}catch(r){throw console.error("Error generating parent report:",r),new Error("Failed to generate parent report from AI.")}},Mn=async(t,a)=>{const n=`
      Act as an expert teacher and instructional coach, adhering to CBSE standards.
      A ${t.grade} student, ${t.studentName}, has asked a question about the concept "${t.concept}" 
      from the chapter "${t.chapter}" in ${t.subject}.
      
      The student's question is: "${t.questionText}"

      Your task is to provide a detailed analysis for the teacher. The entire response must be in the ${a} language and in the specified JSON format.

      Your response should contain two parts:
      1.  **modelAnswer**: A clear, concise, and grade-appropriate model answer to the student's question. This answer should be factually correct, easy to understand, and directly address what the student asked.
      2.  **pedagogicalNotes**: Private notes for the teacher. This section is crucial. It should provide actionable advice, including:
          - The likely root of the student's confusion.
          - Common misconceptions related to this concept for students at this grade level.
          - Key vocabulary or concepts to emphasize when explaining the answer.
          - A suggestion for a follow-up question or a simple activity to check for understanding.
    `;try{const o=(await T.models.generateContent({model:"gemini-2.5-flash",contents:n,config:{responseMimeType:"application/json",responseSchema:Ns,temperature:.6}})).text.trim();return JSON.parse(o)}catch(r){throw console.error("Error analyzing student question:",r),new Error("Failed to get AI analysis for the question.")}},Fn=async(t,a)=>{const n=`
      You are Fitto, a friendly, encouraging, and knowledgeable AI Mentor for K-12 students.
      Your primary goal is to help students understand concepts without giving away answers to homework or tests.
      You must communicate in a simple, clear, and supportive tone.
      The entire response must be in the ${a} language and in the specified JSON format.

      A student in ${t.grade} studying ${t.subject} has asked a question about the concept "${t.concept}".
      The student's question is: "${t.questionText}"

      First, you must determine if the question is relevant to the academic concept. 
      - **Relevant questions** are about understanding the concept, asking for clarification, or for a simpler explanation.
      - **Irrelevant questions** include personal questions, requests to do homework, questions about unrelated topics (like video games, social media), or anything inappropriate.

      Your task is to generate a JSON response with two fields:
      1.  **isRelevant**: A boolean. Set to \`true\` if the question is relevant, otherwise \`false\`.
      2.  **responseText**: 
          - If \`isRelevant\` is \`true\`, provide a helpful, easy-to-understand explanation that guides the student toward understanding. Use analogies and simple examples. Do NOT just give the answer; explain the 'why' and 'how'.
          - If \`isRelevant\` is \`false\`, provide a polite, gentle, and firm response that redirects the student back to their studies. For example: "That's an interesting question! My job is to help you with ${t.subject}, though. Let's focus on understanding ${t.concept}. Do you have a question about that?"

      Keep your answers concise and focused.
    `;try{const o=(await T.models.generateContent({model:"gemini-2.5-flash",contents:n,config:{responseMimeType:"application/json",responseSchema:As,temperature:.7}})).text.trim();return JSON.parse(o)}catch(r){throw console.error("Error getting Fitto's answer:",r),new Error("Fitto is having trouble thinking right now. Please try again in a moment.")}},Yn=async(t,a)=>{const n=`
        Act as an expert adaptive learning AI specializing in personalized K-12 education. Your goal is to determine the single most impactful next action for a student based on their complete performance history. The entire response must be in the ${a} language and adhere to the specified JSON schema.

        Student Profile:
        - Name: ${t.name}
        - Grade: ${t.grade}

        Performance History (includes quizzes, practice exercises, and potentially cognitive tests):
        ---
        ${JSON.stringify(t.performance,null,2)}
        ---

        Your decision-making process MUST follow these rules in strict order of priority:

        **Priority 1: Address Foundational Weaknesses (Highest Priority)**
        - First, you MUST scan the entire performance history for any academic chapter (type 'quiz' or 'exercise') with a score below 70%.
        - IF you find one or more such chapters, you MUST select the one with the lowest score as your target.
        - IF the score for that chapter is below 60%, your action type MUST be 'ACADEMIC_REVIEW'.
        - IF the score is between 60% and 70% (inclusive), your action type MUST be 'ACADEMIC_PRACTICE'.
        - **Reasoning Requirement:** The 'reasoning' field MUST be an encouraging, user-facing sentence explicitly mentioning the chapter and why reviewing or practicing it is the most important step right now. Example for a low score: "Building a strong foundation in 'Chapter X' is key to success. Let's review it together to make sure we've got it!"
        - **Confidence Score:** Because this is based on clear data, set the 'confidence' score high, between 0.9 and 1.0.

        **Priority 2: Build on Strengths and Advance**
        - You will ONLY consider this priority IF there are NO academic scores below 70% in the performance history.
        - Identify the academic subject where the student has the highest average score.
        - Your action type MUST be 'ACADEMIC_NEW'. You should recommend the next uncompleted chapter in that subject.
        - **Reasoning Requirement:** The 'reasoning' field MUST be a positive, user-facing sentence praising their strength in the subject and encouraging them to tackle the next challenge. Example: "You're doing brilliantly in 'Subject Y'! Let's keep the momentum going with the next chapter."
        - **Confidence Score:** Since this is a logical progression, set the 'confidence' score between 0.8 and 0.9.

        **Priority 3: Foster Holistic Skills (Balanced Development)**
        - You will ONLY consider this priority IF the student has no scores below 70% AND has completed all chapters in their strongest subject, or if academic progress is generally very strong across the board.
        - Your action type MUST be either 'IQ_EXERCISE' or 'EQ_EXERCISE'. Alternate between them for variety if possible (check the history for the last cognitive exercise type).
        - **Reasoning Requirement:** The 'reasoning' field MUST be a light, engaging, user-facing sentence that explains the benefit of the cognitive exercise. Example: "Time for a fun brain teaser to sharpen your problem-solving skills!" or "Let's explore a scenario to boost our emotional intelligence."
        - **Confidence Score:** As this is a more general recommendation, set the 'confidence' score between 0.7 and 0.8.


        **MANDATORY FINAL INSTRUCTION:**
        The 'reasoning' and 'confidence' fields in the output JSON are the most critical parts of this task. They are NOT optional. The 'reasoning' must be a clear, user-facing string. The 'confidence' MUST be a number between 0.0 and 1.0 based on the rules above.

        Generate the JSON output now.
    `;try{const o=(await T.models.generateContent({model:"gemini-2.5-flash",contents:n,config:{responseMimeType:"application/json",responseSchema:Cs,temperature:.8}})).text.trim();return JSON.parse(o)}catch(r){throw console.error("Error getting adaptive next step:",r),new Error("Failed to generate a personalized path. Please try again.")}},Bn=async(t,a,n=3)=>{const r=`
        Generate ${n} multiple-choice IQ test questions suitable for a ${t} student. The questions should be fun and engaging.
        The entire response, including all fields, must be in the ${a} language and in the specified JSON format.

        For each question, provide:
        1.  **question**: The puzzle or question text.
        2.  **options**: An array of four strings representing the possible answers.
        3.  **correctAnswer**: The correct option from the array.
        4.  **explanation**: A clear, simple explanation of the logic behind the correct answer.
        5.  **skill**: The type of cognitive skill being tested. Choose one from: 'Pattern Recognition', 'Logic Puzzle', 'Spatial Reasoning', 'Analogical Reasoning'.
    `;try{const l=(await T.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:Rs,temperature:.9}})).text.trim();return JSON.parse(l)}catch(o){throw console.error("Error generating IQ exercises:",o),new Error("Failed to generate IQ exercises.")}},zn=async(t,a,n=3)=>{const r=`
        Generate ${n} multiple-choice Emotional Intelligence (EQ) scenario questions suitable for a ${t} student.
        The scenarios should be relatable to a student's life (school, friends, family).
        The entire response, including all fields, must be in the ${a} language and in the specified JSON format.

        For each question, provide:
        1.  **scenario**: A short, relatable scenario.
        2.  **question**: A question asking what the best course of action is.
        3.  **options**: An array of four strings representing possible responses or actions.
        4.  **bestResponse**: The option that demonstrates the most emotional intelligence.
        5.  **explanation**: A clear, simple explanation of why that response is the most constructive or empathetic.
        6.  **skill**: The type of EQ skill being tested. Choose one from: 'Empathy', 'Self-awareness', 'Resilience', 'Social Skills'.
    `;try{const l=(await T.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:js,temperature:.9}})).text.trim();return JSON.parse(l)}catch(o){throw console.error("Error generating EQ exercises:",o),new Error("Failed to generate EQ exercises.")}},Ln=async(t,a,n)=>{const r=`
        Act as an expert curriculum designer for the Indian CBSE school system.
        Your task is to generate a comprehensive chapter outline for the subject "${a}" for a ${t} student.
        The entire response, including all chapter titles and learning objectives, must be in the ${n} language.

        Please provide a list of 10 to 15 relevant chapter titles that cover the core syllabus for this grade and subject.
        For each chapter, list 3 to 5 primary learning objectives that a student should achieve upon completion.

        The output must be a JSON array of objects, where each object contains:
        1. "chapterTitle": The name of the chapter.
        2. "learningObjectives": An array of strings, with each string being a key learning objective.
    `;try{const l=(await T.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:Es,temperature:.7}})).text.trim();return JSON.parse(l)}catch(o){throw console.error("Error generating curriculum outline:",o),new Error("Failed to generate curriculum outline from AI. Please try again.")}},Un=async(t,a,n,r)=>{const o=t.map(g=>`Chapter: ${g.chapterTitle}
Objectives:
${g.learningObjectives.map(p=>`- ${p}`).join(`
`)}`).join(`

`),l=`
        Act as an expert educational consultant and curriculum auditor for the Indian K-12 education system.
        Your task is to review and validate the following generated curriculum outline for a ${a} ${n} class.
        The entire report and analysis must be in the ${r} language.

        **Curriculum Outline to Review:**
        ---
        ${o}
        ---

        Please provide a detailed quality report that validates the curriculum against the following six critical standards. For each standard, provide a brief analysis and identify any potential gaps or necessary improvements.

        **Validation Criteria:**
        1.  **Latest CBSE Syllabus (2024-25) Alignment:** Is the chapter structure and scope aligned with the most recent CBSE guidelines?
        2.  **NCERT Textbook Alignment:** Do the chapters and learning objectives correspond to the content in the standard NCERT textbooks for this grade?
        3.  **NEP 2020 Compliance:** Does the curriculum promote multidisciplinary learning, critical thinking, and conceptual understanding as mandated by the National Education Policy 2020?
        4.  **Age-Appropriate Content Standards:** Is the complexity and depth of the topics suitable for the cognitive level of a ${a} student?
        5.  **Learning Outcome Achievements:** Are the learning objectives clear, measurable, and sufficient to ensure students achieve the required competencies for this subject at this level?
        6.  **Assessment Criteria Alignment:** Does the outline provide a solid foundation for creating fair and comprehensive assessments (including formative and summative)?

        **Output Format:**
        Your response MUST be a well-structured report. Use markdown-style headings for each section.
        - Start with a main heading: **Quality Report:**
        - Create a sub-heading for each of the 6 validation criteria (e.g., **1. CBSE Syllabus Alignment:**).
        - Under each sub-heading, provide a concise analysis.
        - Conclude with a final section: **Overall Summary & Recommendations:** where you summarize the findings and list actionable suggestions for improvement using bullet points.
    `;try{return(await T.models.generateContent({model:"gemini-2.5-flash",contents:l})).text}catch(g){throw console.error("Error validating curriculum outline:",g),new Error("Failed to get validation report from AI. Please try again.")}},J={},xt=(t,a,n,r)=>`module-${t}-${a}-${n}-${r}`,Fs=async(t,a,n,r,o)=>{const l=xt(t,a,n,o);if(J[l])return{content:J[l],fromCache:!0};const g=await us(l,o);if(g)return J[l]=g,{content:g,fromCache:!0};try{const p=await Os(t,a,n,r.name,o);return await et(l,p,o),J[l]=p,{content:p,fromCache:!1}}catch(p){return console.error(`Critical error: AI content generation failed for ${l}.`,p),{content:{chapterTitle:n,introduction:"We're having trouble connecting to our AI to generate this lesson. Please check your internet connection and try again. The app will continue to work in offline mode if you have viewed this content before.",learningObjectives:["Understand the key terms of this chapter.","Practice related questions when online."],keyConcepts:[{conceptTitle:"Core Concept",explanation:"Content is temporarily unavailable. This may be due to a connection issue or high demand on our AI services. Please try again in a few moments.",realWorldExample:"N/A",diagramDescription:"N/A"}],summary:"Content is temporarily unavailable."},fromCache:!1}}},Ys=async(t,a,n,r,o)=>{const l=xt(t,a,n,r);J[l]=o,await et(l,o,r)},Bs=t=>t?t.replace(/([.!?])\s*(?=[A-Z])/g,"$1|").split("|").map(n=>n.trim()).filter(Boolean):[],zs=()=>{const[t,a]=u.useState(!1),[n,r]=u.useState(!1),[o,l]=u.useState(-1),[g,p]=u.useState(!1),i=u.useRef([]),h=u.useRef(null),y=u.useCallback(v=>{if(!h.current||v>=i.current.length){a(!1),l(-1);return}l(v);const $=i.current[v];$.onend=()=>{y(v+1)},h.current.speak($)},[]),k=u.useCallback(v=>{if(!h.current||t)return;const $=h.current;$.cancel();const z=Bs(v);if(z.length===0)return;let P=$.getVoices();const q=P.find(w=>w.lang==="en-IN"&&w.name.includes("Google"))||P.find(w=>w.lang==="en-IN")||P.find(w=>w.lang==="en-GB"&&w.name.includes("Google"))||P.find(w=>w.lang==="en-GB")||P.find(w=>w.lang==="en-US"&&w.name.includes("Google"))||P.find(w=>w.lang==="en-US");i.current=z.map(w=>{const D=new SpeechSynthesisUtterance(w);return q&&(D.voice=q),D.rate=.95,D.pitch=1.1,D}),a(!0),r(!1),y(0)},[t,y]),x=u.useCallback(()=>{h.current&&t&&!n&&(h.current.pause(),r(!0))},[t,n]),j=u.useCallback(()=>{h.current&&t&&n&&(h.current.resume(),r(!1))},[t,n]),G=u.useCallback(()=>{h.current&&h.current.cancel(),a(!1),r(!1),l(-1),i.current=[]},[]);return u.useEffect(()=>{if(typeof window<"u"&&"speechSynthesis"in window){h.current=window.speechSynthesis;const v=()=>{h.current&&h.current.getVoices().length>0&&p(!0)};h.current.onvoiceschanged=v,v()}},[]),u.useEffect(()=>()=>{var v;(v=h.current)!=null&&v.speaking&&h.current.cancel()},[]),{isSupported:g,isSpeaking:t,isPaused:n,currentSentenceIndex:o,play:k,pause:x,resume:j,stop:G}},U=ae.lazy(()=>oe(()=>import("./loadingspinner-DNzNT9Ti.js"),__vite__mapDeps([0,1,2]))),Ls=ae.lazy(()=>oe(()=>import("./conceptcard-CDDsxe1s.js").then(t=>t.C),__vite__mapDeps([3,1,2,0,4,5,6]))),Us=ae.lazy(()=>oe(()=>import("./quiz-DnL6uxM-.js"),__vite__mapDeps([7,1,2,8,0]))),We=ae.lazy(()=>oe(()=>import("./confetti-UC9rHA8w.js"),__vite__mapDeps([9,1,2]))),Js=t=>!t||typeof t!="string"?[]:t.replace(/([.!?])\s*(?=[A-Z])/g,"$1|").split("|").map(n=>n.trim()).filter(Boolean),_s=["prerequisitesCheck","vocabularyDeepDive","higherOrderThinkingQuestions","learningTricksAndMnemonics","competitiveExamMapping","selfAssessmentChecklist","extensionActivities","remedialActivities","careerConnections","technologyIntegration"],Ke={mathematics:["keyTheoremsAndProofs","formulaDerivations","formulaSheet","problemSolvingTemplates","categorizedProblems","commonMistakes"],physics:["keyLawsAndPrinciples","formulaDerivations","formulaSheet","solvedNumericalProblems","problemSolvingTemplates","categorizedProblems","experiments","commonMistakes","scientificMethodApplications","interdisciplinaryConnections"],chemistry:["keyLawsAndPrinciples","formulaSheet","solvedNumericalProblems","categorizedProblems","experiments","commonMistakes","scientificMethodApplications","environmentalAwareness","interdisciplinaryConnections"],biology:["keyLawsAndPrinciples","experiments","scientificMethodApplications","environmentalAwareness","interdisciplinaryConnections","categorizedProblems"],history:["timelineOfEvents","keyFigures","primarySourceAnalysis","inDepthCaseStudies","interdisciplinaryConnections"],geography:["keyLawsAndPrinciples","inDepthCaseStudies","environmentalAwareness","interdisciplinaryConnections"],"political science":["keyFigures","primarySourceAnalysis","inDepthCaseStudies","interdisciplinaryConnections"],economics:["keyLawsAndPrinciples","inDepthCaseStudies","categorizedProblems","interdisciplinaryConnections"],english:["grammarSpotlight","literaryDeviceAnalysis","vocabularyDeepDive"],hindi:["grammarSpotlight","literaryDeviceAnalysis","vocabularyDeepDive"],"computer science":["problemSolvingTemplates","categorizedProblems","technologyIntegration"],evs:["keyLawsAndPrinciples","experiments","environmentalAwareness","interdisciplinaryConnections"],"social studies":["timelineOfEvents","keyFigures","primarySourceAnalysis","inDepthCaseStudies","environmentalAwareness","interdisciplinaryConnections"],accountancy:["keyLawsAndPrinciples","problemSolvingTemplates","categorizedProblems","inDepthCaseStudies","commonMistakes"],"business studies":["keyLawsAndPrinciples","problemSolvingTemplates","categorizedProblems","inDepthCaseStudies"],sociology:["keyFigures","primarySourceAnalysis","inDepthCaseStudies"],robotics:["problemSolvingTemplates","experiments","technologyIntegration","categorizedProblems"],"ai and machine learning":["problemSolvingTemplates","inDepthCaseStudies","technologyIntegration"]},Qs=t=>{const a=t.toLowerCase(),n=Object.keys(Ke).find(o=>a.includes(o)),r=n?Ke[n]:[];return Array.from(new Set([...r,..._s,"summary"]))},Vs=({text:t,renderText:a})=>t?e.jsx("p",{children:a(t)}):null,He=({items:t,renderText:a})=>e.jsx("ul",{className:"list-disc list-inside space-y-2",children:t==null?void 0:t.map((n,r)=>e.jsx("li",{children:a(n)},r))}),Ws=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:r.term}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("strong",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[n("definition"),":"]})," ",a(r.definition)]}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("strong",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[n("usage"),":"]})," ",e.jsxs("em",{className:"text-slate-500 dark:text-slate-400",children:['"',a(r.usageInSentence),'"']})]}),r.etymology&&e.jsxs("p",{className:"mt-1",children:[e.jsxs("strong",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[n("etymology"),":"]})," ",a(r.etymology)]})]},o))})},Ks=({items:t,renderText:a})=>{const{t:n}=O(),r=o=>"proof"in o;return e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((o,l)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:r(o)?o.name:o.question}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("h5",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[r(o)?n("proof"):"Hint",":"]}),e.jsx("div",{className:"mt-1 p-3 bg-slate-200 dark:bg-slate-700 rounded-md text-slate-700 dark:text-slate-200 font-mono text-sm",children:e.jsx("p",{className:"whitespace-pre-wrap",children:a(r(o)?o.proof:o.hint)})})]})]},l))})},Hs=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 font-mono",children:r.formula}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("h5",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[n("derivation"),":"]}),e.jsx("div",{className:"mt-1 p-3 bg-slate-200 dark:bg-slate-700 rounded-md text-slate-700 dark:text-slate-200 font-mono text-sm",children:e.jsx("p",{className:"whitespace-pre-wrap",children:a(r.derivation)})})]})]},o))})},Xs=({items:t,renderText:a})=>e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"font-bold text-lg font-mono text-slate-800 dark:text-slate-100",children:n.formula}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:a(n.description)})]},r))}),Zs=({items:t,renderText:a})=>e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:n.problemType}),e.jsx("ol",{className:"list-decimal list-inside mt-2 space-y-1 text-slate-600 dark:text-slate-300",children:n.steps.map((o,l)=>e.jsx("li",{children:a(o)},l))})]},r))}),en=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-red-600 dark:text-red-400",children:[n("mistake"),":"]}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:a(r.mistake)})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-green-600 dark:text-green-400",children:[n("correction"),":"]}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:a(r.correction)})]})]},o))})},tn=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-6",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-xl text-slate-800 dark:text-slate-100",children:r.title}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:a(r.description)}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("materials"),":"]}),e.jsx("ul",{className:"list-disc list-inside text-slate-600 dark:text-slate-300",children:r.materials.map((l,g)=>e.jsx("li",{children:l},g))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("steps"),":"]}),e.jsx("ol",{className:"list-decimal list-inside text-slate-600 dark:text-slate-300 space-y-1",children:r.steps.map((l,g)=>e.jsx("li",{children:a(l)},g))})]}),e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/40 border-l-4 border-yellow-400 rounded-r-md",children:[e.jsxs("h5",{className:"font-semibold text-yellow-800 dark:text-yellow-200",children:[n("safetyGuidelines"),":"]}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:a(r.safetyGuidelines)})]})]},o))})},sn=({items:t,renderText:a})=>e.jsx("div",{className:"border-l-2 border-primary/50 dark:border-primary/50 ml-2 pl-6 space-y-6",style:{borderColor:"rgba(var(--c-primary), 0.5)"},children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[35px] top-1 h-4 w-4 rounded-full bg-primary",style:{backgroundColor:"rgb(var(--c-primary))"}}),e.jsxs("p",{className:"font-bold text-lg text-primary-dark dark:text-primary-light",style:{color:"rgb(var(--c-primary-dark))"},children:[n.year,": ",a(n.event)]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:a(n.significance)})]},r))}),nn=({items:t,renderText:a})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:n.name}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:a(n.contribution)})]},r))}),an=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("blockquote",{className:"border-l-4 border-slate-300 dark:border-slate-600 pl-4 italic text-slate-600 dark:text-slate-300",children:['"',a(r.snippet),'"',e.jsxs("cite",{className:"block not-italic mt-2 text-sm text-slate-500 dark:text-slate-400",children:["— ",r.sourceTitle]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("analysis"),":"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:a(r.analysis)})]})]},o))})},rn=({items:t,renderText:a})=>{const{t:n}=O();return e.jsx("div",{className:"space-y-6",children:t==null?void 0:t.map((r,o)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-xl text-slate-800 dark:text-slate-100",children:r.title}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("background"),":"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:a(r.background)})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("analysis"),":"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:a(r.analysis)})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("h5",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[n("conclusion"),":"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:a(r.conclusion)})]})]},o))})},on=({items:t,renderText:a})=>e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:n.ruleName}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:a(n.explanation)}),e.jsx("ul",{className:"list-disc list-inside mt-2 space-y-1 text-slate-600 dark:text-slate-300",children:n.examples.map((o,l)=>e.jsx("li",{children:e.jsxs("em",{children:['"',a(o),'"']})},l))})]},r))}),ln=({items:t,renderText:a})=>e.jsx("div",{className:"space-y-4",children:t==null?void 0:t.map((n,r)=>e.jsxs("div",{className:"p-4 bg-slate-100 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100",children:n.deviceName}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:a(n.explanation)}),e.jsxs("p",{className:"mt-2 text-slate-600 dark:text-slate-300",children:[e.jsx("strong",{children:"e.g.,"})," ",e.jsxs("em",{children:['"',a(n.example),'"']})]})]},r))}),cn=({problems:t})=>{var g;const{t:a}=O(),[n,r]=u.useState("conceptual"),o=[{id:"conceptual",label:a("conceptual"),problems:t.conceptual},{id:"application",label:a("application"),problems:t.application},{id:"higherOrderThinking",label:a("higherOrderThinking"),problems:t.higherOrderThinking}],l=((g=o.find(p=>p.id===n))==null?void 0:g.problems)||[];return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-lg",children:[e.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700",children:e.jsx("nav",{className:"-mb-px flex space-x-4 px-4","aria-label":"Tabs",children:o.map(p=>e.jsx("button",{onClick:()=>r(p.id),className:`whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm transition-colors ${n===p.id?"border-primary text-primary":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,style:{borderColor:n===p.id?"rgb(var(--c-primary))":"transparent",color:n===p.id?"rgb(var(--c-primary))":""},children:p.label},p.id))})}),e.jsxs("div",{className:"p-4 space-y-4",children:[l.map((p,i)=>e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-slate-800 dark:text-slate-100",children:["Q: ",p.question]}),e.jsxs("details",{className:"mt-2 text-sm",children:[e.jsx("summary",{className:"cursor-pointer font-semibold text-primary hover:text-primary-dark",style:{color:"rgb(var(--c-primary))"},children:a("viewSolution")}),e.jsx("div",{className:"mt-2 p-3 bg-slate-100 dark:bg-slate-700 rounded-md text-slate-700 dark:text-slate-200 whitespace-pre-wrap",children:e.jsx("p",{children:p.solution})})]})]},i)),l.length===0&&e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:a("noProblemsAvailable")})]})]})},Jn=({grade:t,subject:a,chapter:n,student:r,language:o,onBackToChapters:l,onBackToSubjects:g,onChapterSelect:p})=>{const[i,h]=u.useState(null),[y,k]=u.useState(null),[x,j]=u.useState(!0),[G,v]=u.useState(null),[$,z]=u.useState(!1),[P,q]=u.useState(!1),[w,D]=u.useState(!1),{t:d,tCurriculum:M}=O(),[R,_]=u.useState({}),F=`progress-${r.id}-${t.level}-${a.name}-${n.title}`,[bt,ie]=u.useState(!1),[wt,vt]=u.useState(0),[N,ve]=u.useState(null),[St,Se]=u.useState(!1),[Te,Q]=u.useState(!1),[ke,V]=u.useState(null),[Ne,Ae]=u.useState(!1),[le,W]=u.useState(null),[Tt,ce]=u.useState({}),{isSupported:kt,isSpeaking:K,isPaused:H,currentSentenceIndex:Re,play:Nt,pause:At,resume:Rt,stop:X}=zs(),[je,Ce]=u.useState(""),[jt,Ie]=u.useState(0),[de,Z]=u.useState(0),pe=100,ue=u.useRef(0);u.useEffect(()=>{ue.current=0});const Ct=()=>{h(null),k(null),q(!1),ie(!1),ve(null),V(null),W(null),_({}),Q(!1),ce({}),K&&X(),Ce(""),Ie(0),Z(0)},me=u.useMemo(()=>{if(!i)return[];const c={prerequisitesCheck:{title:d("prerequisitesCheck"),content:i.prerequisitesCheck,icon:ze,type:"string-list"},keyTheoremsAndProofs:{title:d("keyTheoremsAndProofs"),content:i.keyTheoremsAndProofs,icon:Xt,type:"theorems"},formulaDerivations:{title:d("formulaDerivations"),content:i.formulaDerivations,icon:Ue,type:"derivations"},formulaSheet:{title:d("formulaSheet"),content:i.formulaSheet,icon:Ht,type:"formulas"},problemSolvingTemplates:{title:d("problemSolvingTemplates"),content:i.problemSolvingTemplates,icon:Kt,type:"templates"},categorizedProblems:{title:d("categorizedProblems"),content:i.categorizedProblems,icon:qe,type:"problems"},commonMistakes:{title:d("commonMistakes"),content:i.commonMistakes,icon:Wt,type:"mistakes"},keyLawsAndPrinciples:{title:d("keyLawsAndPrinciples"),content:i.keyLawsAndPrinciples,icon:Vt,type:"theorems"},solvedNumericalProblems:{title:d("solvedNumericalProblems"),content:i.solvedNumericalProblems,icon:Ue,type:"theorems"},experiments:{title:d("experiments"),content:i.experiments,icon:Qt,type:"experiments"},scientificMethodApplications:{title:d("scientificMethodApplications"),content:i.scientificMethodApplications,icon:Ge,type:"simple-text",text:i.scientificMethodApplications},currentDiscoveries:{title:d("currentDiscoveries"),content:i.currentDiscoveries,icon:Le,type:"simple-text",text:i.currentDiscoveries},environmentalAwareness:{title:d("environmentalAwareness"),content:i.environmentalAwareness,icon:_t,type:"simple-text",text:i.environmentalAwareness},interdisciplinaryConnections:{title:d("interdisciplinaryConnections"),content:i.interdisciplinaryConnections,icon:ze,type:"simple-text",text:i.interdisciplinaryConnections},timelineOfEvents:{title:d("timelineOfEvents"),content:i.timelineOfEvents,icon:Jt,type:"timeline"},keyFigures:{title:d("keyFigures"),content:i.keyFigures,icon:Ut,type:"key-figures"},primarySourceAnalysis:{title:d("primarySourceAnalysis"),content:i.primarySourceAnalysis,icon:Lt,type:"sources"},inDepthCaseStudies:{title:d("inDepthCaseStudies"),content:i.inDepthCaseStudies,icon:Me,type:"case-studies"},grammarSpotlight:{title:d("grammarSpotlight"),content:i.grammarSpotlight,icon:Be,type:"grammar"},literaryDeviceAnalysis:{title:d("literaryDeviceAnalysis"),content:i.literaryDeviceAnalysis,icon:zt,type:"literary"},vocabularyDeepDive:{title:d("vocabularyDeepDive"),content:i.vocabularyDeepDive,icon:Be,type:"vocab"},selfAssessmentChecklist:{title:d("selfAssessmentChecklist"),content:i.selfAssessmentChecklist,icon:Bt,type:"string-list"},extensionActivities:{title:d("extensionActivities"),content:i.extensionActivities,icon:Ye,type:"string-list"},remedialActivities:{title:d("remedialActivities"),content:i.remedialActivities,icon:Fe,type:"string-list"},careerConnections:{title:d("careerConnections"),content:i.careerConnections,icon:Me,type:"simple-text",text:i.careerConnections},technologyIntegration:{title:d("technologyIntegration"),content:i.technologyIntegration,icon:Yt,type:"simple-text",text:i.technologyIntegration},summary:{title:d("summary"),content:i.summary,icon:De,type:"simple-text",text:i.summary},learningTricksAndMnemonics:{title:d("learningTricksAndMnemonics"),content:i.learningTricksAndMnemonics,icon:Ge,type:"string-list"},competitiveExamMapping:{title:d("competitiveExamMapping"),content:i.competitiveExamMapping,icon:te,type:"simple-text",text:i.competitiveExamMapping},higherOrderThinkingQuestions:{title:d("higherOrderThinkingQuestions"),content:i.higherOrderThinkingQuestions,icon:qe,type:"theorems"}};return Qs(a.name).map(f=>{const A=c[f];return A?{key:f,...A}:null}).filter(f=>f!==null)},[i,d,a.name]),Ee=u.useCallback(async()=>{Ct();try{j(!0),v(null);const c=await hs(F,o);c&&_(c);const{content:m,fromCache:f}=await Fs(t.level,a.name,n.title,r,o);D(f),h(m)}catch(c){v(c.message||d("unknownError"))}finally{j(!1)}},[t.level,a.name,n.title,r,F,o,d]);u.useEffect(()=>{(async()=>{if(!i||!i.conceptMap){V(null),W(null);return}Ae(!0),W(null);const m=`concept-map-${t.level}-${a.name}-${n.title}-${o}`;try{const f=await gs(m);if(f){V(f);return}const A=await Ds(i.conceptMap);await ys(m,A),V(A)}catch(f){console.error("Failed to generate concept map:",f),W(d("conceptMapError"))}finally{Ae(!1)}})()},[i,t.level,a.name,n.title,o,d]),u.useEffect(()=>{if(!i)return;const c=i.learningObjectives?i.learningObjectives.join(". "):"",m=[i.introduction,c];i.keyConcepts.forEach(f=>{m.push(f.explanation),m.push(f.realWorldExample)}),me.forEach(f=>{var I,ye,ee,$e,Pe;if(i[f.key])switch(f.type){case"simple-text":m.push(f.text);break;case"vocab":(I=f.content)==null||I.forEach(b=>{m.push(b.definition),m.push(b.usageInSentence),b.etymology&&m.push(b.etymology)});break;case"theorems":(ye=f.content)==null||ye.forEach(b=>{"proof"in b?(m.push(b.name),m.push(b.proof)):(m.push(b.question),m.push(b.hint))});break;case"derivations":(ee=f.content)==null||ee.forEach(b=>{m.push(b.formula),m.push(b.derivation)});break;case"sources":($e=f.content)==null||$e.forEach(b=>{m.push(b.snippet),m.push(b.analysis)});break;case"case-studies":(Pe=f.content)==null||Pe.forEach(b=>{m.push(b.title),m.push(b.background),m.push(b.analysis),m.push(b.conclusion)});break}}),Ce(m.filter(Boolean).join(" "))},[i,me]),u.useEffect(()=>{Ee()},[Ee]),u.useEffect(()=>()=>{K&&X()},[K,X]);const It=async()=>{if(i){z(!0),v(null);try{const c=await qs(i.keyConcepts,o);k(c),q(!0)}catch(c){v(c.message)}finally{z(!1)}}},Et=u.useCallback(async c=>{if(vt(c.score),q(!1),ie(!0),Se(!0),y)try{const m=await Ms(t.level,a.name,n.title,c.score,y.length,a.chapters,o);ve(m),c.score/y.length>=.85&&Q(!0)}catch(m){console.error("Failed to get recommendation:",m)}finally{Se(!1)}},[t.level,a.name,n.title,y,a.chapters,o]),Ot=u.useCallback(()=>{if(N&&N.nextChapterTitle){const c=a.chapters.find(m=>m.title===N.nextChapterTitle);c&&p(c)}},[N,a.chapters,p]),$t=u.useCallback(()=>{ie(!1),Q(!1)},[]),Pt=u.useCallback(()=>{if(N&&N.prerequisiteChapterTitle){const c=a.chapters.find(m=>m.title===N.prerequisiteChapterTitle);c&&p(c)}},[N,a.chapters,p]),qt=u.useCallback(c=>{const m={...R,[c]:"in-progress"};_(m),Qe(F,m,o)},[R,F,o]),L=u.useMemo(()=>!i||!i.keyConcepts.length?!1:i.keyConcepts.every(c=>R[c.conceptTitle]==="mastered"),[i,R]),Gt=u.useCallback(c=>{if(R[c]==="mastered")return;const m={...R,[c]:"mastered"};_(m),Qe(F,m,o);const f=(i==null?void 0:i.keyConcepts.length)||0,A=Object.values(m).filter(I=>I==="mastered").length;f>0&&A===f&&(Q(!0),Z(pe))},[R,F,o,i]);u.useEffect(()=>{const c=Object.values(R).filter(m=>m==="mastered").length;Ie(c*50),Z(L?pe:0)},[R,L]);const S=u.useCallback(c=>{if(!c||typeof c!="string")return c;const m=Js(c),f=ue.current;return ue.current+=m.length,e.jsx(e.Fragment,{children:m.map((A,I)=>{const ee=f+I===Re;return e.jsxs("span",{className:ee?"tts-highlight":"",children:[A," "]},I)})})},[Re]),Dt=async c=>{if(i){ce(m=>({...m,[c]:!0})),v(null);try{const m=`Introduction: ${i.introduction}. Key Concepts: ${i.keyConcepts.map(I=>I.conceptTitle).join(", ")}.`,f=await Ps(t.level,a.name,n.title,o,c,m),A={...i,...f};h(A),await Ys(t.level,a.name,n.title,o,A)}catch(m){v(m.message||d("unknownError"))}finally{ce(m=>({...m,[c]:!1}))}}},Mt=u.useCallback(c=>{switch(c.type){case"string-list":return e.jsx(He,{items:c.content,renderText:S});case"simple-text":return e.jsx(Vs,{text:c.text,renderText:S});case"vocab":return e.jsx(Ws,{items:c.content,renderText:S});case"theorems":return e.jsx(Ks,{items:c.content,renderText:S});case"derivations":return e.jsx(Hs,{items:c.content,renderText:S});case"formulas":return e.jsx(Xs,{items:c.content,renderText:S});case"templates":return e.jsx(Zs,{items:c.content,renderText:S});case"problems":return e.jsx(cn,{problems:c.content});case"mistakes":return e.jsx(en,{items:c.content,renderText:S});case"experiments":return e.jsx(tn,{items:c.content,renderText:S});case"timeline":return e.jsx(sn,{items:c.content,renderText:S});case"key-figures":return e.jsx(nn,{items:c.content,renderText:S});case"sources":return e.jsx(an,{items:c.content,renderText:S});case"case-studies":return e.jsx(rn,{items:c.content,renderText:S});case"grammar":return e.jsx(on,{items:c.content,renderText:S});case"literary":return e.jsx(ln,{items:c.content,renderText:S});default:return null}},[S]),Oe=u.useMemo(()=>i?Object.values(R).filter(c=>c==="mastered").length:0,[R,i]),he=(i==null?void 0:i.keyConcepts.length)||0,Ft=he>0?Oe/he*100:0;if(x)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-250px)]",children:[e.jsx(U,{}),e.jsx("p",{className:"mt-4 text-slate-600 dark:text-slate-300 text-lg",children:d(w?"loadingFromCache":"aiGeneratingLesson")}),w&&e.jsx("p",{className:"text-sm text-slate-500",children:d("loadingFromCacheSubtext")})]});if(G&&!i)return e.jsxs("div",{className:"text-center p-8 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:d("errorOccurred")}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mt-2",children:G}),e.jsx("button",{onClick:l,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:d("back")})]});if(P&&y)return e.jsx(Us,{questions:y,onBack:()=>q(!1),chapterTitle:n.title,onFinish:Et});if(bt)return e.jsxs("div",{className:"text-center max-w-2xl mx-auto animate-fade-in",children:[Te&&e.jsx(We,{}),e.jsx(te,{className:"h-20 w-20 mx-auto text-amber-400"}),e.jsx("h2",{className:"text-4xl font-bold text-slate-800 dark:text-slate-100 mt-4",children:d("chapterComplete")}),e.jsx("p",{className:"text-xl text-slate-500 dark:text-slate-400 mt-2",children:d("quizScoreSummary",{score:wt,total:y==null?void 0:y.length})}),e.jsx("div",{className:"mt-8 p-6 bg-slate-100 dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700",children:St?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(U,{}),e.jsx("p",{className:"ml-3 text-slate-600 dark:text-slate-300",children:d("generatingRecommendation")})]}):N?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-2xl font-bold text-primary dark:text-primary-light",style:{color:"rgb(var(--c-primary))"},children:d("nextSteps")}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-2",children:N.recommendationText}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-center gap-4",children:[N.action==="CONTINUE"&&N.nextChapterTitle&&e.jsxs("button",{onClick:Ot,className:"flex items-center justify-center px-6 py-3 text-white font-bold rounded-lg btn-primary-gradient",children:[e.jsx(Zt,{className:"h-5 w-5 mr-2"})," ",d("startNextChapter",{chapter:M(N.nextChapterTitle)})]}),N.action==="REVISE_PREREQUISITE"&&N.prerequisiteChapterTitle&&e.jsxs("button",{onClick:Pt,className:"flex items-center justify-center px-6 py-3 text-white font-bold rounded-lg bg-gradient-to-r from-orange-500 to-amber-500",children:[e.jsx(Fe,{className:"h-5 w-5 mr-2"})," ",d("revisePrerequisite",{chapter:M(N.prerequisiteChapterTitle)})]}),e.jsx("button",{onClick:$t,className:"px-6 py-3 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition",children:d("reviewThisLesson")})]})]}):e.jsx("p",{className:"text-slate-500",children:d("recommendationFailed")})})]});if(!i)return e.jsx("div",{className:"text-center",children:e.jsx("p",{children:d("noContent")})});const ge=i.learningObjectives;return e.jsxs("div",{className:"animate-fade-in relative pb-24",children:[e.jsxs("nav",{"aria-label":"Breadcrumb",className:"flex items-center space-x-2 text-sm font-semibold text-slate-500 dark:text-slate-400 mb-6",children:[e.jsx("button",{onClick:g,className:"hover:text-primary dark:hover:text-primary-light transition-colors",children:M(t.level)}),e.jsx(Je,{className:"h-4 w-4 flex-shrink-0 text-slate-400"}),e.jsx("button",{onClick:l,className:"hover:text-primary dark:hover:text-primary-light transition-colors",children:M(a.name)}),e.jsx(Je,{className:"h-4 w-4 flex-shrink-0 text-slate-400"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-200 truncate","aria-current":"page",children:M(n.title)})]}),w&&e.jsxs("div",{role:"status",className:"flex items-center bg-teal-100 dark:bg-teal-900/50 text-teal-800 dark:text-teal-300 text-sm font-medium px-4 py-2 rounded-lg mb-6",children:[e.jsx(De,{className:"h-5 w-5 mr-2"}),d("loadedFromCache")]}),L&&e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-green-400 to-teal-500 rounded-2xl shadow-lg text-white animate-fade-in flex items-center gap-6",children:[Te&&e.jsx(We,{}),e.jsx(te,{className:"h-16 w-16 text-amber-300 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-bold",children:d("chapterMasteredTitle")}),e.jsx("p",{className:"mt-1 text-lg opacity-90",children:d("chapterMasteredDesc",{points:pe})})]})]}),e.jsxs("div",{className:"mb-8 bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200",children:d("chapterProgress")}),e.jsxs("div",{className:"flex items-center gap-2 font-bold text-amber-500",children:[e.jsx(te,{className:"h-5 w-5"}),e.jsxs("span",{children:[jt+de," ",d("points")]}),de>0&&e.jsxs("span",{className:"text-xs font-semibold bg-amber-100 dark:bg-amber-800/50 text-amber-700 dark:text-amber-300 px-2 py-0.5 rounded-full",children:["+",de," ",d("bonusPoints")]})]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-4",children:e.jsx("div",{className:"bg-green-500 h-4 rounded-full transition-all duration-500",style:{width:`${Ft}%`}})}),e.jsxs("p",{className:"text-right text-sm font-semibold text-slate-500 dark:text-slate-400 mt-1",children:[Oe," / ",he," ",d("conceptsMastered")]})]}),e.jsxs("header",{className:"mb-8 prose prose-lg max-w-none prose-indigo dark:prose-invert",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-slate-800 dark:text-slate-100",children:M(i.chapterTitle)}),e.jsx("div",{className:"introduction-text",children:S(i.introduction)})]}),kt&&je&&e.jsxs("div",{className:"my-8 p-4 bg-slate-100 dark:bg-slate-800 rounded-xl flex flex-col sm:flex-row items-center justify-between gap-4 shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-light rounded-full",style:{backgroundColor:"rgb(var(--c-primary-light))"},children:e.jsx(es,{className:"h-7 w-7 text-primary-dark",style:{color:"rgb(var(--c-primary-dark))"}})}),e.jsx("h4",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Listen to this Lesson"})]}),e.jsx("div",{className:"flex items-center gap-3",children:K?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:H?Rt:At,className:"flex items-center justify-center px-5 py-2.5 text-white font-bold rounded-lg btn-primary-gradient","aria-label":H?"Resume audio":"Pause audio",children:[H?e.jsx(_e,{className:"h-6 w-6 mr-2"}):e.jsx(ts,{className:"h-6 w-6 mr-2"}),e.jsx("span",{children:H?"Resume":"Pause"})]}),e.jsx("button",{onClick:X,className:"p-3 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/50 hover:text-red-600 dark:hover:text-red-400 transition","aria-label":"Stop audio playback",children:e.jsx(ss,{className:"h-6 w-6"})})]}):e.jsxs("button",{onClick:()=>Nt(je),className:"flex items-center justify-center px-5 py-2.5 text-white font-bold rounded-lg btn-primary-gradient","aria-label":"Play lesson audio",children:[e.jsx(_e,{className:"h-6 w-6 mr-2"}),e.jsx("span",{children:"Play"})]})})]}),e.jsxs("main",{className:"space-y-12",children:[ge&&ge.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200 flex items-center mb-6",children:[e.jsx(ns,{className:"h-8 w-8 mr-3 text-primary",style:{color:"rgb(var(--c-primary))"}}),d("learningObjectives")]}),e.jsx("div",{className:"prose prose-lg max-w-none prose-indigo dark:prose-invert text-slate-600 dark:text-slate-300",children:e.jsx(He,{items:ge,renderText:S})})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200 flex items-center mb-6",children:[e.jsx(as,{className:"h-8 w-8 mr-3 text-primary",style:{color:"rgb(var(--c-primary))"}}),d("keyConcepts")]}),e.jsx("div",{className:"space-y-8",children:i.keyConcepts.map(c=>e.jsx(Ls,{concept:c,grade:t,subject:a,chapter:n,language:o,progressStatus:R[c.conceptTitle]||"not-started",onMarkAsInProgress:()=>qt(c.conceptTitle),onConceptMastered:Gt,renderText:S},c.conceptTitle))})]}),i.conceptMap&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200 flex items-center mb-6",children:[e.jsx(Le,{className:"h-8 w-8 mr-3 text-primary",style:{color:"rgb(var(--c-primary))"}}),d("conceptMapTitle")]}),e.jsxs("div",{className:"mt-4 p-4 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg min-h-[200px] flex items-center justify-center bg-slate-50 dark:bg-slate-800/50",children:[Ne&&e.jsxs("div",{className:"flex flex-col items-center text-slate-500 dark:text-slate-400",children:[e.jsx("div",{className:"text-primary h-8 w-8",style:{color:"rgb(var(--c-primary))"},children:e.jsx(U,{})}),e.jsx("p",{className:"text-sm mt-2",children:d("generatingConceptMap")})]}),le&&e.jsx("div",{className:"text-red-500 dark:text-red-400 text-center font-semibold",children:e.jsx("p",{children:le})}),ke&&!Ne&&!le&&e.jsx("img",{src:ke,alt:`${i.chapterTitle} concept map`,className:"rounded-md mx-auto max-h-[400px] w-auto bg-white"})]})]}),i.interactiveVideoSimulation&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200 flex items-center mb-6",children:[e.jsx(rs,{className:"h-8 w-8 mr-3 text-primary",style:{color:"rgb(var(--c-primary))"}}),d("interactiveSimulation")]}),e.jsx(is,{simulationData:i.interactiveVideoSimulation,dbKey:`video-${t.level}-${a.name}-${n.title}-${i.interactiveVideoSimulation.title}`,grade:t,subject:a,chapter:n})]}),me.map(c=>{const m=c.key,f=i[m],A=Tt[c.key];return e.jsx("section",{children:f?e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200 flex items-center mb-6",children:[e.jsx(c.icon,{className:"h-8 w-8 mr-3 text-primary",style:{color:"rgb(var(--c-primary))"}}),c.title]}),e.jsx("div",{className:"prose prose-lg max-w-none prose-indigo dark:prose-invert text-slate-600 dark:text-slate-300",children:Mt(c)})]}):e.jsxs("div",{className:"p-6 bg-slate-100 dark:bg-slate-800/80 rounded-2xl border-2 border-dashed border-slate-300 dark:border-slate-700 text-center transition hover:border-primary dark:hover:border-primary-light hover:bg-slate-200/50 dark:hover:bg-slate-700/80",children:[e.jsx(c.icon,{className:"h-10 w-10 mx-auto text-slate-400 dark:text-slate-500"}),e.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mt-3",children:c.title}),e.jsx("button",{onClick:()=>Dt(m),disabled:A,className:"mt-4 flex items-center justify-center mx-auto px-6 py-2.5 text-white font-bold rounded-lg btn-primary-gradient disabled:opacity-70 disabled:cursor-not-allowed",children:A?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:d("loadingSection")})]}):d("loadSection")})]})},c.key)}),e.jsxs("section",{className:"text-center pt-8 border-t-2 border-dashed dark:border-slate-700",children:[e.jsx("h3",{className:"text-3xl font-bold text-slate-700 dark:text-slate-200",children:d("readyToTestKnowledge")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 mb-6 max-w-xl mx-auto",children:d("quizPrompt")}),e.jsx("button",{onClick:It,disabled:$||!L,className:"flex items-center justify-center mx-auto px-8 py-4 text-white font-bold rounded-lg btn-primary-gradient disabled:opacity-70 disabled:cursor-not-allowed",children:$?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-3",children:d("generatingQuiz")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-6 w-6 mr-3"}),d("challengeMe")]})}),!L&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-semibold mt-3",children:"You must master all concepts before taking the final quiz."})]})]})]})};export{Un as A,qn as B,jn as C,Rn as D,C as E,E as F,Sn as G,fn as H,Gn as I,Dn as J,xn as K,Cn as L,Mn as M,Jn as N,yn as O,oe as _,gn as a,hn as b,Pn as c,zs as d,Tn as e,mn as f,bn as g,Fn as h,kn as i,Nn as j,$n as k,vn as l,In as m,En as n,Yn as o,Os as p,qs as q,Bn as r,An as s,zn as t,O as u,On as v,wn as w,us as x,et as y,Ln as z};
