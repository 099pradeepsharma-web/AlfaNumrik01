import{r as n,j as e,G as S,C as R,v as C}from"./vendor_react-DXiryTHP.js";import{u as V,B as E,C as L,D as U}from"./chapterview-B02STcsL.js";import b from"./loadingspinner-DNzNT9Ti.js";const P={"grade-11-science-physics-motion-in-a-straight-line":"https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4"},I=(s,a,c)=>`${s}-${a}-${c}`.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),g=["Contacting the AI director...","This is a special one-time process...","Your contribution will help other students learn faster!","Storyboarding the main ideas...","Setting up the digital scene...","Rendering the first few frames...","Applying digital effects and animations...","Polishing the final cut...","Almost there, the simulation is loading!"],O=({simulationData:s,dbKey:a,grade:c,subject:h})=>{const{t:d}=V(),[t,l]=n.useState("checking"),[i,u]=n.useState(null),[v,x]=n.useState(null),[j,w]=n.useState(g[0]);n.useEffect(()=>(t==="checking"&&(async()=>{const o=I(c.level,h.name,s.title),f=P[o];if(f){u(f),l("pregenerated");return}const p=await U(a);if(p){u(URL.createObjectURL(p)),l("cached");return}l("idle")})(),()=>{i&&(t==="cached"||t==="ready")&&URL.revokeObjectURL(i)}),[a,c.level,h.name,s.title,t,i]),n.useEffect(()=>{let r;if(t==="generating"){let o=0;r=window.setInterval(()=>{o=(o+1)%g.length,w(g[o])},3e3)}return()=>clearInterval(r)},[t]);const m=n.useCallback(async()=>{l("generating"),x(null);try{const r=await E(s.videoPrompt);await L(a,r),u(URL.createObjectURL(r)),l("ready")}catch(r){console.error("Video generation failed:",r),x(r.message||"An unknown error occurred during video generation."),l("error")}},[s.videoPrompt,a]),y=()=>i?e.jsx("video",{src:i,controls:!0,autoPlay:!0,className:"w-full h-full object-contain",crossOrigin:t==="pregenerated"?"anonymous":void 0,children:"Your browser does not support the video tag."}):null,k=()=>{switch(t){case"checking":return e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-slate-800 text-white",children:[e.jsx(b,{}),e.jsx("p",{className:"mt-2 text-sm font-semibold",children:"Checking for video..."})]});case"pregenerated":case"cached":case"ready":return y();case"generating":return e.jsxs("div",{className:"text-center p-4 video-simulation-card-gradient w-full h-full flex flex-col items-center justify-center",children:[e.jsx(b,{}),e.jsx("p",{className:"mt-4 font-semibold text-white/90 text-lg video-loading-message",children:j}),e.jsx("p",{className:"text-sm text-white/70 mt-1",children:"(This helps build our library for everyone!)"})]});case"error":return e.jsxs("div",{className:"text-center p-4 bg-red-100 dark:bg-red-900/50 w-full h-full flex flex-col items-center justify-center rounded-lg",children:[e.jsx(C,{className:"h-10 w-10 text-red-500"}),e.jsx("p",{className:"mt-3 font-semibold text-red-700 dark:text-red-300",children:d("videoGenerationError")}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:v}),e.jsx("button",{onClick:m,className:"mt-4 px-4 py-2 text-sm bg-primary text-white font-semibold rounded-lg",children:d("retryButton")})]});case"idle":default:return e.jsxs("div",{className:"text-center p-4 video-simulation-card-gradient w-full h-full flex flex-col items-center justify-center",children:[e.jsx("h4",{className:"text-2xl font-bold text-white mb-4",children:"Visualize this Concept"}),e.jsxs("button",{onClick:m,className:"flex items-center gap-3 px-6 py-3 bg-white/20 text-white font-bold rounded-full text-lg backdrop-blur-sm border border-white/30 hover:bg-white/30 transition transform hover:scale-105",children:[e.jsx(R,{className:"h-8 w-8"}),d("generateVideoSimulation")]})]})}},N=()=>t==="pregenerated"||t==="cached"?e.jsxs("div",{className:"flex items-center gap-1 text-xs font-semibold text-green-700 dark:text-green-300 bg-green-100 dark:bg-green-900/50 px-2 py-1 rounded-full",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:"Instantly Available"})]}):null;return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl p-6 transition-shadow hover:shadow-md not-prose",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:s.title}),N()]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-2",children:s.description}),e.jsx("div",{className:"mt-6 aspect-video w-full bg-slate-900 rounded-lg flex items-center justify-center overflow-hidden",children:k()})]})};export{O as V};
